define(["backbone","text!tpl/GigDetails.html","./number-of-tickets-view","models/order-model","collections/ordersCollection","views/login-with-gig-details-view"],function(e,t,n,r,i,s){var o=e.View.extend({tagName:"div",className:"gigDetails",template:_.template(t),events:{"click #get_tickets":"getTickets"},initialize:function(){console.log("in initialize() of gig-detail-view.js"),this.is_reserve_tickets_cookie_present=this.parse_cookie_string(),console.log("this.is_reserve_tickets_cookie_present: "+this.is_reserve_tickets_cookie_present),console.log("this.options: ");for(var e in this.options)console.log(this.options[e])},render:function(){return console.log("in gig-detail-view.js and render()"),this.$el.html(this.template(this.model.toJSON())),console.log("this.model: "),console.dir(this.model),this.currentView=this,this},getTickets:function(){console.log("in getTickets click handler.");var e=this;$.ajax({url:"/api/users/session",type:"GET",success:function(t,r,i){console.log("SUCCESS: got $.ajax GET /api/users/session"),console.dir(t),console.log("textStatus: "+r),console.dir(i);if(!t.user_authenticated){var o=new s({model:e.model});e.showView("#featureContent",o)}else if(t.user_authenticated===!0){console.log("self.is_reserve_tickets_cookie_present: "+e.is_reserve_tickets_cookie_present);if(e.is_reserve_tickets_cookie_present)e.reserve_tickets_release();else{var u=new n({model:e.model});e.showView("#featureContent",u),window.scrollTo(0,350)}}},error:function(e,t,n){console.log("ERROR: tried to $.ajax GET /api/users/session"),console.dir(e),console.log("textStatus: "+t),console.log("errorThrown: "+n),alert("Internal Error: try again")}})},parse_cookie_string:function(){this.cookies_obj={},this.cookies_array=document.cookie.split(";"),console.log("this.cookies_array:"),console.dir(this.cookies_array);for(var e in this.cookies_array){var t=this.cookies_array[e].substring(0,this.cookies_array[e].indexOf("=")),n=this.cookies_array[e].substring(this.cookies_array[e].indexOf("=")+1);t=t.replace(/^\s+|\s+$/g,""),this.cookies_obj[t]=n}return this.cookies_obj.reserve_tickets?!0:!1},reserve_tickets_release:function(){var e=this;console.log("this.is_reserve_tickets_cookie_present: "+this.is_reserve_tickets_cookie_present),console.log("checking for reserve_tickets cookie presence..."),$.ajax({url:"/api/orders/ticket_reserve_release_from_navigation",type:"GET",success:function(t,r,i){console.log("SUCCESS: released tickets due to navigating away"),console.dir(t),console.log("textStatus: "+r),console.dir(i),e.is_reserve_tickets_cookie_present=!1,console.log("successful release of reserved tix. go onto to next view");var s=new n({model:e.model});e.showView("#featureContent",s),window.scrollTo(0,350)},error:function(e,t,n){console.log("ERROR: in releasing tickets dut to navigating away"),console.dir(e),console.log("textStatus: "+t),console.dir(n),alert("internal error: try again later")}})},showView:function(e,t){return console.log("in showView in gig-detail-view.js"),this.currentView&&this.currentView.close(),$(e).html(t.render().el),this.currentView=t,t}});return o});