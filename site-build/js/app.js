//     (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/**
 * @license RequireJS text 2.0.6 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
 * Braintree End-to-End Encryption Library
 * https://www.braintreepayments.com
 * Copyright (c) 2009-2013 Braintree Payment Solutions
 *
 * JSBN
 * Copyright (c) 2005  Tom Wu
 *
 * Both Licensed under the MIT License.
 * http://opensource.org/licenses/MIT
 *
 * ASN.1 JavaScript decoder
 * Copyright (c) 2008-2009 Lapo Luchini <lapo@lapo.it>
 * Licensed under the ISC License.
 * http://opensource.org/licenses/ISC
 */

/* =============================================================
 * bootstrap-collapse.js v2.2.2
 * http://twitter.github.com/bootstrap/javascript.html#collapse
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

(function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="1.0.0";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender||e.$,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=o.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,f=o.length;a<f;a++){e=o[a];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(c=0,h=s.length;c<h;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;typeof t=="object"&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=u.uniqueId("l"));return i[s]=t,typeof n=="object"&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(o,a);var p=o.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(t,d)),t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},j(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t;if(r&&(!n||!n.wait)&&!this.set(r,n))return!1;n=u.extend({validate:!0},n);if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);n.wait&&(t=u.extend(r||{},t));if(u.isObject(t)&&!a.set(t,n))return!1;f&&f(a,e,n),a.trigger("sync",a,e,n)},j(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;j(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||B();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t||{},{validationError:n})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];u.each(v,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var m=o.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};u.extend(m.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.defaults(t||{},y))},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},set:function(e,t){t=u.defaults(t||{},g),t.parse&&(e=this.parse(e,t)),u.isArray(e)||(e=e?[e]:[]);var n,i,o,a,f,l,c=t.at,h=this.comparator&&c==null&&t.sort!==!1,p=u.isString(this.comparator)?this.comparator:null,d=[],v=[],m={};for(n=0,i=e.length;n<i;n++){if(!(o=this._prepareModel(e[n],t)))continue;(f=this.get(o))?(t.remove&&(m[f.cid]=!0),t.merge&&(f.set(o.attributes,t),h&&!l&&f.hasChanged(p)&&(l=!0))):t.add&&(d.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o))}if(t.remove){for(n=0,i=this.length;n<i;++n)m[(o=this.models[n]).cid]||v.push(o);v.length&&this.remove(v,t)}d.length&&(h&&(l=!0),this.length+=d.length,c!=null?s.apply(this.models,[c,0].concat(d)):r.apply(this.models,d)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,i=d.length;n<i;n++)(o=d[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(b,function(e){m.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var w=["groupBy","countBy","sortBy"];u.each(w,function(e){m.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var E=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];u.extend(E.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(S),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,x)),this.options=e},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}}),o.sync=function(e,t,n){var r=T[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||B()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled)&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,a,n),a};var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var N=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(e,t,n){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return o.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),o.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=u.result(this,"routes");var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=D.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(_,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!O.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new O;var H=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=m.extend=N.extend=E.extend=O.extend=H;var B=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}).call(this),define("backbone",function(){}),define("text",["module"],function(e){var t,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a=typeof location!="undefined"&&location.href,f=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||undefined),h=[],p=e.config&&e.config()||{};t={version:"2.0.6",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(h[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}p.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),h=p.useXhr||t.useXhr;!a||h(u,f,l,c)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(h.hasOwnProperty(n)){var s=t.jsEscape(h[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(p.env==="node"||!p.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("ï»¿")===0&&(r=r.substring(1)),t(r)};else if(p.env==="xhr"||!p.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),p.onXhrComplete&&p.onXhrComplete(s,e))},s.send(null)};else if(p.env==="rhino"||!p.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(p.env==="xpconnect"||!p.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,s,o={},u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),s.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),o),s.close(),n.close(),t(o.value)}catch(a){throw new Error((u&&u.path||"")+": "+a)}};return t}),define("text!tpl/BannerView.html",[],function(){return'<html>\n  <div class="banner_view">\n    <img src="http://d11x7re0mdurt0.cloudfront.net/img/main-banner.jpg"/>\n    <h1>Tiklet Ticketing</h1>\n  </div>\n<html>\n'}),define("views/banner-view",["backbone","text!tpl/BannerView.html"],function(e,t){var n=e.View.extend({el:"#banner",template:_.template(t),className:"bannerContainer",initialize:function(){this.render()},render:function(){return this.$el.html(this.template()),this}});return n}),define("text!tpl/HeaderView.html",[],function(){return'<html>\n  <div class="navbar navbar-inverse navbar-fixed-top">\n    <div class="navbar-inner">\n\n      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->\n      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n      </a>\n\n\n      <a class="brand active" href="#/">Tiklet</a>\n\n      <div class="nav-collapse collapse">\n        <ul class="nav pull-right">\n          <li><a href="#/gigs">GIGS</a></li>\n	  <li><a href="#/about">ABOUT</a></li>\n          <li><a href="#/contact">CONTACT</a></li>\n          <li><a href="#/account" id="account">ACCOUNT</a></li>\n          <li><a href="#/login" id="login_header">LOGIN</a></li> \n          <li><a href="#/logout" id="logout_header">LOGOUT</a></li> \n        </ul>\n      </div>\n\n\n\n    </div>\n  </div>\n</html>\n'}),define("views/header-view",["backbone","text!tpl/HeaderView.html"],function(e,t){var n=e.View.extend({el:"#container-fluid",template:_.template(t),initialize:function(){this.render()},render:function(){return this.$el.html(this.template()),this}});return n}),define("text!tpl/GigListItemView.html",[],function(){return'<html>\n\n  <div class="row-fluid"><a href="/#/gigs/<%= _id %>">\n    <div class="span3"><img src="<%= image_url%>" width="100px" height="100px"></div>\n    <div class="span6"><h5><%= main_event %></h5><h5><%= supports %></h5><h5><%= venue %></h5><h5><%= price %></h5></div>\n    <div class="span3">GET TICKETS</div>\n \n  </a></div>\n</html>\n\n'}),define("text!tpl/GigDetails.html",[],function(){return'<html>\n  <h2>Gig Details</h2>\n    <img src="<%= image_url %>" />\n  <ul>\n    <li><b>Main Event: </b><%= main_event   %></li>\n    <li><b>Event Date: </b><%= $.format.date(new Date(event_date), \'dd MMMM yyyy\') %></li>\n    <li><b>Opening Time: </b><%= opening_time %></li>\n    <li><b>Venue: </b><%= venue       %></li>\n    <li><b>Price: </b><%= price       %></li>\n    <li><b>Supports: </b><%= supports    %></li>\n    <li><b>Age Group: </b><%= age_group    %></li>\n    <li><b>Description: </b><%= description %></li>\n    <li><b>Tag Names: </b><% _.each(tag_names, function(tagObj) {%> <%= tagObj.tag %> <% }); %></li>\n  </ul>\n\n\n<div class="proceed" id="get_tickets">GET TICKETS</div>\n\n</html>\n'}),define("text!tpl/NumberOfTicketsView.html",[],function(){return'<html>\n  <h2>WORK IN PROGRESS: Number of Tickets View</h2>\n  <h4> TOTAL AMOUNT: $ <span id="total_amount"></span></h4>  \n\n  <div id="ticket_amount_one"   class="ticket_select">1 TIX</div>\n  <div id="ticket_amount_two"   class="ticket_select">2 TIX</div>\n  <div id="ticket_amount_three" class="ticket_select">3 TIX</div>\n  <div id="ticket_amount_four"  class="ticket_select">4 TIX</div>\n  <div id="ticket_amount_five"  class="ticket_select">5 TIX</div>\n  <div id="ticket_amount_six"   class="ticket_select">6 TIX</div>\n  <div id="ticket_amount_seven" class="ticket_select">7 TIX</div>\n  <div id="ticket_amount_eight" class="ticket_select">8 TIX</div>\n\n  <div class="proceed" id="submit">PROCEED TO PAYMENT</div>\n</html>\n\n'}),define("models/order-model",["backbone"],function(){var e=Backbone.Model.extend({idAttribute:"_id",initialize:function(){console.log("HELLLLLOOO from order-model.js initialize land. Woot.")},defaults:{cc_number:"backbone_default",cc_cvv:"backbone_default",cc_month:"backbone_default",cc_year:"backbone_default",gig_id:"backbone_default",user_id:"backbone_default",braintree_customer_id:"backbone_default",user_authenticated:!1,number_of_tickets:0,ticket_price:0,transaction_amount:0,transaction_id:"backbone_default",transaction_status:"backbone_default",main_event:"backbone_default",event_date:new Date,venue:"backbone_default",opening_time:"backbone_default",age_group:"backbone_default"}});return e}),define("collections/ordersCollection",["backbone","models/order-model"],function(e,t){var n=e.Collection.extend({model:t,url:"/api/orders/"});return n}),function(){function e(t,n){t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=n)}function t(e,t,n,r,i){this.stream=e,this.header=t,this.length=n,this.tag=r,this.sub=i}function i(e){var t,i,s="";for(t=0;t+3<=e.length;t+=3)i=parseInt(e.substring(t,t+3),16),s+=n.charAt(i>>6)+n.charAt(i&63);t+1==e.length?(i=parseInt(e.substring(t,t+1),16),s+=n.charAt(i<<2)):t+2==e.length&&(i=parseInt(e.substring(t,t+2),16),s+=n.charAt(i>>2)+n.charAt((i&3)<<4));while((s.length&3)>0)s+=r;return s}function s(e){var t="",i,s=0,o;for(i=0;i<e.length;++i){if(e.charAt(i)==r)break;v=n.indexOf(e.charAt(i));if(v<0)continue;s==0?(t+=E(v>>2),o=v&3,s=1):s==1?(t+=E(o<<2|v>>4),o=v&15,s=2):s==2?(t+=E(o),t+=E(v>>2),o=v&3,s=3):(t+=E(o<<2|v>>4),t+=E(v&15),s=0)}return s==1&&(t+=E(o<<2)),t}function o(e){var t=s(e),n,r=new Array;for(n=0;2*n<t.length;++n)r[n]=parseInt(t.substring(2*n,2*n+2),16);return r}function l(e,t,n){e!=null&&("number"==typeof e?this.fromNumber(e,t,n):t==null&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function c(){return new l(null)}function h(e,t,n,r,i,s){while(--s>=0){var o=t*this[e++]+n[r]+i;i=Math.floor(o/67108864),n[r++]=o&67108863}return i}function p(e,t,n,r,i,s){var o=t&32767,u=t>>15;while(--s>=0){var a=this[e]&32767,f=this[e++]>>15,l=u*a+f*o;a=o*a+((l&32767)<<15)+n[r]+(i&1073741823),i=(a>>>30)+(l>>>15)+u*f+(i>>>30),n[r++]=a&1073741823}return i}function d(e,t,n,r,i,s){var o=t&16383,u=t>>14;while(--s>=0){var a=this[e]&16383,f=this[e++]>>14,l=u*a+f*o;a=o*a+((l&16383)<<14)+n[r]+i,i=(a>>28)+(l>>14)+u*f,n[r++]=a&268435455}return i}function E(e){return g.charAt(e)}function S(e,t){var n=y[e.charCodeAt(t)];return n==null?-1:n}function x(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function T(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0}function N(e){var t=c();return t.fromInt(e),t}function C(e,t){var n;if(t==16)n=4;else if(t==8)n=3;else if(t==256)n=8;else if(t==2)n=1;else if(t==32)n=5;else{if(t!=4){this.fromRadix(e,t);return}n=2}this.t=0,this.s=0;var r=e.length,i=!1,s=0;while(--r>=0){var o=n==8?e[r]&255:S(e,r);if(o<0){e.charAt(r)=="-"&&(i=!0);continue}i=!1,s==0?this[this.t++]=o:s+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,s+=n,s>=this.DB&&(s-=this.DB)}n==8&&(e[0]&128)!=0&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&l.ZERO.subTo(this,this)}function k(){var e=this.s&this.DM;while(this.t>0&&this[this.t-1]==e)--this.t}function L(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else{if(e!=4)return this.toRadix(e);t=2}var n=(1<<t)-1,r,i=!1,s="",o=this.t,u=this.DB-o*this.DB%t;if(o-->0){u<this.DB&&(r=this[o]>>u)>0&&(i=!0,s=E(r));while(o>=0)u<t?(r=(this[o]&(1<<u)-1)<<t-u,r|=this[--o]>>(u+=this.DB-t)):(r=this[o]>>(u-=t)&n,u<=0&&(u+=this.DB,--o)),r>0&&(i=!0),i&&(s+=E(r))}return i?s:"0"}function A(){var e=c();return l.ZERO.subTo(this,e),e}function O(){return this.s<0?this.negate():this}function M(e){var t=this.s-e.s;if(t!=0)return t;var n=this.t;t=n-e.t;if(t!=0)return this.s<0?-t:t;while(--n>=0)if((t=this[n]-e[n])!=0)return t;return 0}function _(e){var t=1,n;return(n=e>>>16)!=0&&(e=n,t+=16),(n=e>>8)!=0&&(e=n,t+=8),(n=e>>4)!=0&&(e=n,t+=4),(n=e>>2)!=0&&(e=n,t+=2),(n=e>>1)!=0&&(e=n,t+=1),t}function D(){return this.t<=0?0:this.DB*(this.t-1)+_(this[this.t-1]^this.s&this.DM)}function P(e,t){var n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s}function H(e,t){for(var n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s}function B(e,t){var n=e%this.DB,r=this.DB-n,i=(1<<r)-1,s=Math.floor(e/this.DB),o=this.s<<n&this.DM,u;for(u=this.t-1;u>=0;--u)t[u+s+1]=this[u]>>r|o,o=(this[u]&i)<<n;for(u=s-1;u>=0;--u)t[u]=0;t[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()}function j(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}var r=e%this.DB,i=this.DB-r,s=(1<<r)-1;t[0]=this[n]>>r;for(var o=n+1;o<this.t;++o)t[o-n-1]|=(this[o]&s)<<i,t[o-n]=this[o]>>r;r>0&&(t[this.t-n-1]|=(this.s&s)<<i),t.t=this.t-n,t.clamp()}function F(e,t){var n=0,r=0,i=Math.min(e.t,this.t);while(n<i)r+=this[n]-e[n],t[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){r-=e.s;while(n<this.t)r+=this[n],t[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{r+=this.s;while(n<e.t)r-=e[n],t[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[n++]=this.DV+r:r>0&&(t[n++]=r),t.t=n,t.clamp()}function I(e,t){var n=this.abs(),r=e.abs(),i=n.t;t.t=i+r.t;while(--i>=0)t[i]=0;for(i=0;i<r.t;++i)t[i+n.t]=n.am(0,r[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&l.ZERO.subTo(t,t)}function q(e){var t=this.abs(),n=e.t=2*t.t;while(--n>=0)e[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()}function R(e,t,n){var r=e.abs();if(r.t<=0)return;var i=this.abs();if(i.t<r.t){t!=null&&t.fromInt(0),n!=null&&this.copyTo(n);return}n==null&&(n=c());var s=c(),o=this.s,u=e.s,a=this.DB-_(r[r.t-1]);a>0?(r.lShiftTo(a,s),i.lShiftTo(a,n)):(r.copyTo(s),i.copyTo(n));var f=s.t,h=s[f-1];if(h==0)return;var p=h*(1<<this.F1)+(f>1?s[f-2]>>this.F2:0),d=this.FV/p,v=(1<<this.F1)/p,m=1<<this.F2,g=n.t,y=g-f,b=t==null?c():t;s.dlShiftTo(y,b),n.compareTo(b)>=0&&(n[n.t++]=1,n.subTo(b,n)),l.ONE.dlShiftTo(f,b),b.subTo(s,s);while(s.t<f)s[s.t++]=0;while(--y>=0){var w=n[--g]==h?this.DM:Math.floor(n[g]*d+(n[g-1]+m)*v);if((n[g]+=s.am(0,w,n,y,0,f))<w){s.dlShiftTo(y,b),n.subTo(b,n);while(n[g]<--w)n.subTo(b,n)}}t!=null&&(n.drShiftTo(f,t),o!=u&&l.ZERO.subTo(t,t)),n.t=f,n.clamp(),a>0&&n.rShiftTo(a,n),o<0&&l.ZERO.subTo(n,n)}function U(e){var t=c();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(l.ZERO)>0&&e.subTo(t,t),t}function z(e){this.m=e}function W(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function X(e){return e}function V(e){e.divRemTo(this.m,null,e)}function $(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function J(e,t){e.squareTo(t),this.reduce(t)}function K(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Q(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function G(e){var t=c();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(l.ZERO)>0&&this.m.subTo(t,t),t}function Y(e){var t=c();return e.copyTo(t),this.reduce(t),t}function Z(e){while(e.t<=this.mt2)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=e[t]&32767,r=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;n=t+this.m.t,e[n]+=this.m.am(0,r,e,t,0,this.m.t);while(e[n]>=e.DV)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function et(e,t){e.squareTo(t),this.reduce(t)}function tt(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function nt(){return(this.t>0?this[0]&1:this.s)==0}function rt(e,t){if(e>4294967295||e<1)return l.ONE;var n=c(),r=c(),i=t.convert(this),s=_(e)-1;i.copyTo(n);while(--s>=0){t.sqrTo(n,r);if((e&1<<s)>0)t.mulTo(r,i,n);else{var o=n;n=r,r=o}}return t.revert(n)}function it(e,t){var n;return e<256||t.isEven()?n=new z(t):n=new Q(t),this.exp(e,n)}function st(e,t){return new l(e,t)}function ot(e,t){var n="",r=0;while(r+t<e.length)n+=e.substring(r,r+t)+"\n",r+=t;return n+e.substring(r,e.length)}function ut(e){return e<16?"0"+e.toString(16):e.toString(16)}function at(e,t){if(t<e.length+11)return alert("Message too long for RSA"),null;var n=new Array,r=e.length-1;while(r>=0&&t>0){var i=e.charCodeAt(r--);i<128?n[--t]=i:i>127&&i<2048?(n[--t]=i&63|128,n[--t]=i>>6|192):(n[--t]=i&63|128,n[--t]=i>>6&63|128,n[--t]=i>>12|224)}n[--t]=0;var s=0,o=0,u=0;while(t>2)u==0&&(o=dt.random.randomWords(1,0)[0]),s=o>>u&255,u=(u+8)%32,s!=0&&(n[--t]=s);return n[--t]=2,n[--t]=0,new l(n)}function ft(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function lt(e,t){e!=null&&t!=null&&e.length>0&&t.length>0?(this.n=st(e,16),this.e=parseInt(t,16)):alert("Invalid RSA public key")}function ct(e){return e.modPowInt(this.e,this.n)}function ht(e){var t=at(e,this.n.bitLength()+7>>3);if(t==null)return null;var n=this.doPublic(t);if(n==null)return null;var r=n.toString(16);return(r.length&1)==0?r:"0"+r}function pt(e){var t=this.encrypt(e);return t?i(t):null}e.prototype.get=function(e){e==undefined&&(e=this.pos++);if(e>=this.enc.length)throw"Requesting byte offset "+e+" on a stream of length "+this.enc.length;return this.enc[e]},e.prototype.hexDigits="0123456789ABCDEF",e.prototype.hexByte=function(e){return this.hexDigits.charAt(e>>4&15)+this.hexDigits.charAt(e&15)},e.prototype.hexDump=function(e,t){var n="";for(var r=e;r<t;++r){n+=this.hexByte(this.get(r));switch(r&15){case 7:n+="  ";break;case 15:n+="\n";break;default:n+=" "}}return n},e.prototype.parseStringISO=function(e,t){var n="";for(var r=e;r<t;++r)n+=String.fromCharCode(this.get(r));return n},e.prototype.parseStringUTF=function(e,t){var n="",r=0;for(var i=e;i<t;){var r=this.get(i++);r<128?n+=String.fromCharCode(r):r>191&&r<224?n+=String.fromCharCode((r&31)<<6|this.get(i++)&63):n+=String.fromCharCode((r&15)<<12|(this.get(i++)&63)<<6|this.get(i++)&63)}return n},e.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,e.prototype.parseTime=function(e,t){var n=this.parseStringISO(e,t),r=this.reTime.exec(n);return r?(n=r[1]+"-"+r[2]+"-"+r[3]+" "+r[4],r[5]&&(n+=":"+r[5],r[6]&&(n+=":"+r[6],r[7]&&(n+="."+r[7]))),r[8]&&(n+=" UTC",r[8]!="Z"&&(n+=r[8],r[9]&&(n+=":"+r[9]))),n):"Unrecognized time: "+n},e.prototype.parseInteger=function(e,t){var n=t-e;if(n>4){n<<=3;var r=this.get(e);if(r==0)n-=8;else while(r<128)r<<=1,--n;return"("+n+" bit)"}var i=0;for(var s=e;s<t;++s)i=i<<8|this.get(s);return i},e.prototype.parseBitString=function(e,t){var n=this.get(e),r=(t-e-1<<3)-n,i="("+r+" bit)";if(r<=20){var s=n;i+=" ";for(var o=t-1;o>e;--o){var u=this.get(o);for(var a=s;a<8;++a)i+=u>>a&1?"1":"0";s=0}}return i},e.prototype.parseOctetString=function(e,t){var n=t-e,r="("+n+" byte) ";n>20&&(t=e+20);for(var i=e;i<t;++i)r+=this.hexByte(this.get(i));return n>20&&(r+=String.fromCharCode(8230)),r},e.prototype.parseOID=function(e,t){var n,r=0,i=0;for(var s=e;s<t;++s){var o=this.get(s);r=r<<7|o&127,i+=7,o&128||(n==undefined?n=parseInt(r/40)+"."+r%40:n+="."+(i>=31?"bigint":r),r=i=0),n+=String.fromCharCode()}return n},t.prototype.typeName=function(){if(this.tag==undefined)return"unknown";var e=this.tag>>6,t=this.tag>>5&1,n=this.tag&31;switch(e){case 0:switch(n){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+n.toString(16)};case 1:return"Application_"+n.toString(16);case 2:return"["+n+"]";case 3:return"Private_"+n.toString(16)}},t.prototype.content=function(){if(this.tag==undefined)return null;var e=this.tag>>6;if(e!=0)return this.sub==null?null:"("+this.sub.length+")";var t=this.tag&31,n=this.posContent(),r=Math.abs(this.length);switch(t){case 1:return this.stream.get(n)==0?"false":"true";case 2:return this.stream.parseInteger(n,n+r);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(n,n+r);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(n,n+r);case 6:return this.stream.parseOID(n,n+r);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(n,n+r);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(n,n+r);case 23:case 24:return this.stream.parseTime(n,n+r)}return null},t.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub==null?"null":this.sub.length)+"]"},t.prototype.print=function(e){e==undefined&&(e=""),document.writeln(e+this);if(this.sub!=null){e+="  ";for(var t=0,n=this.sub.length;t<n;++t)this.sub[t].print(e)}},t.prototype.toPrettyString=function(e){e==undefined&&(e="");var t=e+this.typeName()+" @"+this.stream.pos;this.length>=0&&(t+="+"),t+=this.length,this.tag&32?t+=" (constructed)":(this.tag==3||this.tag==4)&&this.sub!=null&&(t+=" (encapsulates)"),t+="\n";if(this.sub!=null){e+="  ";for(var n=0,r=this.sub.length;n<r;++n)t+=this.sub[n].toPrettyString(e)}return t},t.prototype.posStart=function(){return this.stream.pos},t.prototype.posContent=function(){return this.stream.pos+this.header},t.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},t.decodeLength=function(e){var t=e.get(),n=t&127;if(n==t)return n;if(n>3)throw"Length over 24 bits not supported at position "+(e.pos-1);if(n==0)return-1;t=0;for(var r=0;r<n;++r)t=t<<8|e.get();return t},t.hasContent=function(n,r,i){if(n&32)return!0;if(n<3||n>4)return!1;var s=new e(i);n==3&&s.get();var o=s.get();if(o>>6&1)return!1;try{var u=t.decodeLength(s);return s.pos-i.pos+u==r}catch(a){return!1}},t.decode=function(n){n instanceof e||(n=new e(n,0));var r=new e(n),i=n.get(),s=t.decodeLength(n),o=n.pos-r.pos,u=null;if(t.hasContent(i,s,n)){var a=n.pos;i==3&&n.get(),u=[];if(s>=0){var f=a+s;while(n.pos<f)u[u.length]=t.decode(n);if(n.pos!=f)throw"Content size is not correct for container starting at offset "+a}else try{for(;;){var l=t.decode(n);if(l.tag==0)break;u[u.length]=l}s=a-n.pos}catch(c){throw"Exception while decoding undefined length content: "+c}}else n.pos+=s;return new t(r,o,s,i,u)};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="=",u,a=0xdeadbeefcafe,f=(a&16777215)==15715070;f&&navigator.appName=="Microsoft Internet Explorer"?(l.prototype.am=p,u=30):f&&navigator.appName!="Netscape"?(l.prototype.am=h,u=26):(l.prototype.am=d,u=28),l.prototype.DB=u,l.prototype.DM=(1<<u)-1,l.prototype.DV=1<<u;var m=52;l.prototype.FV=Math.pow(2,m),l.prototype.F1=m-u,l.prototype.F2=2*u-m;var g="0123456789abcdefghijklmnopqrstuvwxyz",y=new Array,b,w;b="0".charCodeAt(0);for(w=0;w<=9;++w)y[b++]=w;b="a".charCodeAt(0);for(w=10;w<36;++w)y[b++]=w;b="A".charCodeAt(0);for(w=10;w<36;++w)y[b++]=w;z.prototype.convert=W,z.prototype.revert=X,z.prototype.reduce=V,z.prototype.mulTo=$,z.prototype.sqrTo=J,Q.prototype.convert=G,Q.prototype.revert=Y,Q.prototype.reduce=Z,Q.prototype.mulTo=tt,Q.prototype.sqrTo=et,l.prototype.copyTo=x,l.prototype.fromInt=T,l.prototype.fromString=C,l.prototype.clamp=k,l.prototype.dlShiftTo=P,l.prototype.drShiftTo=H,l.prototype.lShiftTo=B,l.prototype.rShiftTo=j,l.prototype.subTo=F,l.prototype.multiplyTo=I,l.prototype.squareTo=q,l.prototype.divRemTo=R,l.prototype.invDigit=K,l.prototype.isEven=nt,l.prototype.exp=rt,l.prototype.toString=L,l.prototype.negate=A,l.prototype.abs=O,l.prototype.compareTo=M,l.prototype.bitLength=D,l.prototype.mod=U,l.prototype.modPowInt=it,l.ZERO=N(0),l.ONE=N(1),ft.prototype.doPublic=ct,ft.prototype.setPublic=lt,ft.prototype.encrypt=ht,ft.prototype.encrypt_b64=pt;var dt={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};typeof module!="undefined"&&module.exports&&(module.exports=dt),dt.cipher.aes=function(e){this._tables[0][0][0]||this._precompute();var t,n,r,i,s,o=this._tables[0][4],u=this._tables[1],a=e.length,f=1;if(a!==4&&a!==6&&a!==8)throw new dt.exception.invalid("invalid aes key size");this._key=[i=e.slice(0),s=[]];for(t=a;t<4*a+28;t++){r=i[t-1];if(t%a===0||a===8&&t%a===4)r=o[r>>>24]<<24^o[r>>16&255]<<16^o[r>>8&255]<<8^o[r&255],t%a===0&&(r=r<<8^r>>>24^f<<24,f=f<<1^(f>>7)*283);i[t]=i[t-a]^r}for(n=0;t;n++,t--)r=i[n&3?t:t-4],t<=4||n<4?s[n]=r:s[n]=u[0][o[r>>>24]]^u[1][o[r>>16&255]]^u[2][o[r>>8&255]]^u[3][o[r&255]]},dt.cipher.aes.prototype={encrypt:function(e){return this._crypt(e,0)},decrypt:function(e){return this._crypt(e,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var e=this._tables[0],t=this._tables[1],n=e[4],r=t[4],i,s,o,u=[],a=[],f,l,c,h,p,d;for(i=0;i<256;i++)a[(u[i]=i<<1^(i>>7)*283)^i]=i;for(s=o=0;!n[s];s^=f||1,o=a[o]||1){h=o^o<<1^o<<2^o<<3^o<<4,h=h>>8^h&255^99,n[s]=h,r[h]=s,c=u[l=u[f=u[s]]],d=c*16843009^l*65537^f*257^s*16843008,p=u[h]*257^h*16843008;for(i=0;i<4;i++)e[i][s]=p=p<<24^p>>>8,t[i][h]=d=d<<24^d>>>8}for(i=0;i<5;i++)e[i]=e[i].slice(0),t[i]=t[i].slice(0)},_crypt:function(e,t){if(e.length!==4)throw new dt.exception.invalid("invalid aes block size");var n=this._key[t],r=e[0]^n[0],i=e[t?3:1]^n[1],s=e[2]^n[2],o=e[t?1:3]^n[3],u,a,f,l=n.length/4-2,c,h=4,p=[0,0,0,0],d=this._tables[t],v=d[0],m=d[1],g=d[2],y=d[3],b=d[4];for(c=0;c<l;c++)u=v[r>>>24]^m[i>>16&255]^g[s>>8&255]^y[o&255]^n[h],a=v[i>>>24]^m[s>>16&255]^g[o>>8&255]^y[r&255]^n[h+1],f=v[s>>>24]^m[o>>16&255]^g[r>>8&255]^y[i&255]^n[h+2],o=v[o>>>24]^m[r>>16&255]^g[i>>8&255]^y[s&255]^n[h+3],h+=4,r=u,i=a,s=f;for(c=0;c<4;c++)p[t?3&-c:c]=b[r>>>24]<<24^b[i>>16&255]<<16^b[s>>8&255]<<8^b[o&255]^n[h++],u=r,r=i,i=s,s=o,o=u;return p}},dt.bitArray={bitSlice:function(e,t,n){return e=dt.bitArray._shiftRight(e.slice(t/32),32-(t&31)).slice(1),n===undefined?e:dt.bitArray.clamp(e,n-t)},extract:function(e,t,n){var r,i=Math.floor(-t-n&31);return(t+n-1^t)&-32?r=e[t/32|0]<<32-i^e[t/32+1|0]>>>i:r=e[t/32|0]>>>i,r&(1<<n)-1},concat:function(e,t){if(e.length===0||t.length===0)return e.concat(t);var n,r,i=e[e.length-1],s=dt.bitArray.getPartial(i);return s===32?e.concat(t):dt.bitArray._shiftRight(t,s,i|0,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length,n;return t===0?0:(n=e[t-1],(t-1)*32+dt.bitArray.getPartial(n))},clamp:function(e,t){if(e.length*32<t)return e;e=e.slice(0,Math.ceil(t/32));var n=e.length;return t&=31,n>0&&t&&(e[n-1]=dt.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return e===32?t:(n?t|0:t<<32-e)+e*1099511627776},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(dt.bitArray.bitLength(e)!==dt.bitArray.bitLength(t))return!1;var n=0,r;for(r=0;r<e.length;r++)n|=e[r]^t[r];return n===0},_shiftRight:function(e,t,n,r){var i,s=0,o;r===undefined&&(r=[]);for(;t>=32;t-=32)r.push(n),n=0;if(t===0)return r.concat(e);for(i=0;i<e.length;i++)r.push(n|e[i]>>>t),n=e[i]<<32-t;return s=e.length?e[e.length-1]:0,o=dt.bitArray.getPartial(s),r.push(dt.bitArray.partial(t+o&31,t+o>32?n:r.pop(),1)),r},_xor4:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]}},dt.codec.hex={fromBits:function(e){var t="",n,r;for(n=0;n<e.length;n++)t+=((e[n]|0)+0xf00000000000).toString(16).substr(4);return t.substr(0,dt.bitArray.bitLength(e)/4)},toBits:function(e){var t,n=[],r;e=e.replace(/\s|0x/g,""),r=e.length,e+="00000000";for(t=0;t<e.length;t+=8)n.push(parseInt(e.substr(t,8),16)^0);return dt.bitArray.clamp(n,r*4)}},dt.codec.utf8String={fromBits:function(e){var t="",n=dt.bitArray.bitLength(e),r,i;for(r=0;r<n/8;r++)(r&3)===0&&(i=e[r/4]),t+=String.fromCharCode(i>>>24),i<<=8;return decodeURIComponent(escape(t))},toBits:function(e){e=unescape(encodeURIComponent(e));var t=[],n,r=0;for(n=0;n<e.length;n++)r=r<<8|e.charCodeAt(n),(n&3)===3&&(t.push(r),r=0);return n&3&&t.push(dt.bitArray.partial(8*(n&3),r)),t}},dt.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,n){var r="",i,s=0,o=dt.codec.base64._chars,u=0,a=dt.bitArray.bitLength(e);n&&(o=o.substr(0,62)+"-_");for(i=0;r.length*6<a;)r+=o.charAt((u^e[i]>>>s)>>>26),s<6?(u=e[i]<<6-s,s+=26,i++):(u<<=6,s-=6);while(r.length&3&&!t)r+="=";return r},toBits:function(e,t){e=e.replace(/\s|=/g,"");var n=[],r,i=0,s=dt.codec.base64._chars,o=0,u;t&&(s=s.substr(0,62)+"-_");for(r=0;r<e.length;r++){u=s.indexOf(e.charAt(r));if(u<0)throw new dt.exception.invalid("this isn't base64!");i>26?(i-=26,n.push(o^u>>>i),o=u<<32-i):(i+=6,o^=u<<32-i)}return i&56&&n.push(dt.bitArray.partial(i&56,o,1)),n}},dt.codec.base64url={fromBits:function(e){return dt.codec.base64.fromBits(e,1,1)},toBits:function(e){return dt.codec.base64.toBits(e,1)}},dt.beware===undefined&&(dt.beware={}),dt.beware["CBC mode is dangerous because it doesn't protect message integrity."]=function(){dt.mode.cbc={name:"cbc",encrypt:function(e,t,n,r){if(r&&r.length)throw new dt.exception.invalid("cbc can't authenticate data");if(dt.bitArray.bitLength(n)!==128)throw new dt.exception.invalid("cbc iv must be 128 bits");var i,s=dt.bitArray,o=s._xor4,u=s.bitLength(t),a=0,f=[];if(u&7)throw new dt.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(i=0;a+128<=u;i+=4,a+=128)n=e.encrypt(o(n,t.slice(i,i+4))),f.splice(i,0,n[0],n[1],n[2],n[3]);return u=(16-(u>>3&15))*16843009,n=e.encrypt(o(n,s.concat(t,[u,u,u,u]).slice(i,i+4))),f.splice(i,0,n[0],n[1],n[2],n[3]),f},decrypt:function(e,t,n,r){if(r&&r.length)throw new dt.exception.invalid("cbc can't authenticate data");if(dt.bitArray.bitLength(n)!==128)throw new dt.exception.invalid("cbc iv must be 128 bits");if(dt.bitArray.bitLength(t)&127||!t.length)throw new dt.exception.corrupt("cbc ciphertext must be a positive multiple of the block size");var i,s=dt.bitArray,o=s._xor4,u,a,f=[];r=r||[];for(i=0;i<t.length;i+=4)u=t.slice(i,i+4),a=o(n,e.decrypt(u)),f.splice(i,0,a[0],a[1],a[2],a[3]),n=u;u=f[i-1]&255;if(u==0||u>16)throw new dt.exception.corrupt("pkcs#5 padding corrupt");a=u*16843009;if(!s.equal(s.bitSlice([a,a,a,a],0,u*8),s.bitSlice(f,f.length*32-u*8,f.length*32)))throw new dt.exception.corrupt("pkcs#5 padding corrupt");return s.bitSlice(f,0,f.length*32-u*8)}}},dt.misc.hmac=function(e,t){this._hash=t=t||dt.hash.sha256;var n=[[],[]],r,i=t.prototype.blockSize/32;this._baseHash=[new t,new t],e.length>i&&(e=t.hash(e));for(r=0;r<i;r++)n[0][r]=e[r]^909522486,n[1][r]=e[r]^1549556828;this._baseHash[0].update(n[0]),this._baseHash[1].update(n[1])},dt.misc.hmac.prototype.encrypt=dt.misc.hmac.prototype.mac=function(e,t){var n=(new this._hash(this._baseHash[0])).update(e,t).finalize();return(new this._hash(this._baseHash[1])).update(n).finalize()},dt.hash.sha256=function(e){this._key[0]||this._precompute(),e?(this._h=e._h.slice(0),this._buffer=e._buffer.slice(0),this._length=e._length):this.reset()},dt.hash.sha256.hash=function(e){return(new dt.hash.sha256).update(e).finalize()},dt.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(e){typeof e=="string"&&(e=dt.codec.utf8String.toBits(e));var t,n=this._buffer=dt.bitArray.concat(this._buffer,e),r=this._length,i=this._length=r+dt.bitArray.bitLength(e);for(t=512+r&-512;t<=i;t+=512)this._block(n.splice(0,16));return this},finalize:function(){var e,t=this._buffer,n=this._h;t=dt.bitArray.concat(t,[dt.bitArray.partial(1,1)]);for(e=t.length+2;e&15;e++)t.push(0);t.push(Math.floor(this._length/4294967296)),t.push(this._length|0);while(t.length)this._block(t.splice(0,16));return this.reset(),n},_init:[],_key:[],_precompute:function(){function r(e){return(e-Math.floor(e))*4294967296|0}var e=0,t=2,n;e:for(;e<64;t++){for(n=2;n*n<=t;n++)if(t%n===0)continue e;e<8&&(this._init[e]=r(Math.pow(t,.5))),this._key[e]=r(Math.pow(t,1/3)),e++}},_block:function(e){var t,n,r,i,s=e.slice(0),o=this._h,u=this._key,a=o[0],f=o[1],l=o[2],c=o[3],h=o[4],p=o[5],d=o[6],v=o[7];for(t=0;t<64;t++)t<16?n=s[t]:(r=s[t+1&15],i=s[t+14&15],n=s[t&15]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s[t&15]+s[t+9&15]|0),n=n+v+(h>>>6^h>>>11^h>>>25^h<<26^h<<21^h<<7)+(d^h&(p^d))+u[t],v=d,d=p,p=h,h=c+n|0,c=l,l=f,f=a,a=n+(f&l^c&(f^l))+(f>>>2^f>>>13^f>>>22^f<<30^f<<19^f<<10)|0;o[0]=o[0]+a|0,o[1]=o[1]+f|0,o[2]=o[2]+l|0,o[3]=o[3]+c|0,o[4]=o[4]+h|0,o[5]=o[5]+p|0,o[6]=o[6]+d|0,o[7]=o[7]+v|0}},dt.random={randomWords:function(e,t){var n=[],r,i=this.isReady(t),s;if(i===this._NOT_READY)throw new dt.exception.notReady("generator isn't seeded");i&this._REQUIRES_RESEED&&this._reseedFromPools(!(i&this._READY));for(r=0;r<e;r+=4)(r+1)%this._MAX_WORDS_PER_BURST===0&&this._gate(),s=this._gen4words(),n.push(s[0],s[1],s[2],s[3]);return this._gate(),n.slice(0,e)},setDefaultParanoia:function(e){this._defaultParanoia=e},addEntropy:function(e,t,n){n=n||"user";var r,i,s,o=(new Date).valueOf(),u=this._robins[n],a=this.isReady(),f=0;r=this._collectorIds[n],r===undefined&&(r=this._collectorIds[n]=this._collectorIdNext++),u===undefined&&(u=this._robins[n]=0),this._robins[n]=(this._robins[n]+1)%this._pools.length;switch(typeof e){case"number":t===undefined&&(t=1),this._pools[u].update([r,this._eventId++,1,t,o,1,e|0]);break;case"object":var l=Object.prototype.toString.call(e);if(l==="[object Uint32Array]"){s=[];for(i=0;i<e.length;i++)s.push(e[i]);e=s}else{l!=="[object Array]"&&(f=1);for(i=0;i<e.length&&!f;i++)typeof e[i]!="number"&&(f=1)}if(!f){if(t===undefined){t=0;for(i=0;i<e.length;i++){s=e[i];while(s>0)t++,s>>>=1}}this._pools[u].update([r,this._eventId++,2,t,o,e.length].concat(e))}break;case"string":t===undefined&&(t=e.length),this._pools[u].update([r,this._eventId++,3,t,o,e.length]),this._pools[u].update(e);break;default:f=1}if(f)throw new dt.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[u]+=t,this._poolStrength+=t,a===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(e){var t=this._PARANOIA_LEVELS[e!==undefined?e:this._defaultParanoia];return this._strength&&this._strength>=t?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=t?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(e){var t=this._PARANOIA_LEVELS[e?e:this._defaultParanoia];return this._strength>=t?1:this._poolStrength>t?1:this._poolStrength/t},startCollectors:function(){if(this._collectorsStarted)return;if(window.addEventListener)window.addEventListener("load",this._loadTimeCollector,!1),window.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw new dt.exception.bug("can't attach event");document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectorsStarted=!0},stopCollectors:function(){if(!this._collectorsStarted)return;window.removeEventListener?(window.removeEventListener("load",this._loadTimeCollector,!1),window.removeEventListener("mousemove",this._mouseCollector,!1)):window.detachEvent&&(window.detachEvent("onload",this._loadTimeCollector),window.detachEvent("onmousemove",this._mouseCollector)),this._collectorsStarted=!1},addEventListener:function(e,t){this._callbacks[e][this._callbackI++]=t},removeEventListener:function(e,t){var n,r,i=this._callbacks[e],s=[];for(r in i)i.hasOwnProperty(r)&&i[r]===t&&s.push(r);for(n=0;n<s.length;n++)r=s[n],delete i[r]},_pools:[new dt.hash.sha256],_poolEntropy:[0],_reseedCount:0,_robins:{},_eventId:0,_collectorIds:{},_collectorIdNext:0,_strength:0,_poolStrength:0,_nextReseed:0,_key:[0,0,0,0,0,0,0,0],_counter:[0,0,0,0],_cipher:undefined,_defaultParanoia:6,_collectorsStarted:!1,_callbacks:{progress:{},seeded:{}},_callbackI:0,_NOT_READY:0,_READY:1,_REQUIRES_RESEED:2,_MAX_WORDS_PER_BURST:65536,_PARANOIA_LEVELS:[0,48,64,96,128,192,256,384,512,768,1024],_MILLISECONDS_PER_RESEED:3e4,_BITS_PER_RESEED:80,_gen4words:function(){for(var e=0;e<4;e++){this._counter[e]=this._counter[e]+1|0;if(this._counter[e])break}return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new dt.cipher.aes(this._key)},_reseed:function(e){this._key=dt.hash.sha256.hash(this._key.concat(e)),this._cipher=new dt.cipher.aes(this._key);for(var t=0;t<4;t++){this._counter[t]=this._counter[t]+1|0;if(this._counter[t])break}},_reseedFromPools:function(e){var t=[],n=0,r;this._nextReseed=t[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED;for(r=0;r<16;r++)t.push(Math.random()*4294967296|0);for(r=0;r<this._pools.length;r++){t=t.concat(this._pools[r].finalize()),n+=this._poolEntropy[r],this._poolEntropy[r]=0;if(!e&&this._reseedCount&1<<r)break}this._reseedCount>=1<<this._pools.length&&(this._pools.push(new dt.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=n,n>this._strength&&(this._strength=n),this._reseedCount++,this._reseed(t)},_mouseCollector:function(e){var t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0;dt.random.addEntropy([t,n],2,"mouse")},_loadTimeCollector:function(e){dt.random.addEntropy((new Date).valueOf(),2,"loadtime")},_fireEvent:function(e,t){var n,r=dt.random._callbacks[e],i=[];for(n in r)r.hasOwnProperty(n)&&i.push(r[n]);for(n=0;n<i.length;n++)i[n](t)}},function(){try{var e=new Uint32Array(32);crypto.getRandomValues(e),dt.random.addEntropy(e,1024,"crypto.getRandomValues")}catch(t){}}(),function(){for(var e in dt.beware)dt.beware.hasOwnProperty(e)&&dt.beware[e]()}();var vt={sjcl:dt,version:"1.3.5"};vt.generateAesKey=function(){return{key:dt.random.randomWords(8,0),encrypt:function(e){return this.encryptWithIv(e,dt.random.randomWords(4,0))},encryptWithIv:function(e,t){var n=new dt.cipher.aes(this.key),r=dt.codec.utf8String.toBits(e),i=dt.mode.cbc.encrypt(n,r,t),s=dt.bitArray.concat(t,i);return dt.codec.base64.fromBits(s)}}},vt.create=function(e){return new vt.EncryptionClient(e)},vt.EncryptionClient=function(e){var n=this,r=[];n.publicKey=e,n.version=vt.version;var i=function(e,t){var n,r,i;n=document.createElement(e);for(r in t)t.hasOwnProperty(r)&&(i=t[r],n.setAttribute(r,i));return n},s=function(e){return window.jQuery&&e instanceof jQuery?e[0]:e.nodeType&&e.nodeType===1?e:document.getElementById(e)},u=function(e){var t=[],n,r,i,s;e.typeName()==="INTEGER"&&(n=e.posContent(),r=e.posEnd(),i=e.stream.hexDump(n,r).replace(/[ \n]/g,""),t.push(i));if(e.sub!==null)for(s=0;s<e.sub.length;s++)t=t.concat(u(e.sub[s]));return t},a=function(e){var t=[],n=e.children,r,i;for(i=0;i<n.length;i++)r=n[i],r.nodeType===1&&r.attributes["data-encrypted-name"]?t.push(r):r.children.length>0&&(t=t.concat(a(r)));return t},f=function(){var n,r,i,s,a;try{n=o(e),r=t.decode(n)}catch(f){throw"Invalid encryption key. Please use the key labeled 'Client-Side Encryption Key'"}i=u(r);if(i.length!==2)throw"Invalid encryption key. Please use the key labeled 'Client-Side Encryption Key'";return s=i[0],a=i[1],rsa=new ft,rsa.setPublic(s,a),rsa},l=function(){return{key:dt.random.randomWords(8,0),sign:function(e){var t=new dt.misc.hmac(this.key,dt.hash.sha256),n=t.encrypt(e);return dt.codec.base64.fromBits(n)}}};n.encrypt=function(e){var t=f();return aes=vt.generateAesKey(),hmac=l(),ciphertext=aes.encrypt(e),signature=hmac.sign(dt.codec.base64.toBits(ciphertext)),combinedKey=dt.bitArray.concat(aes.key,hmac.key),encodedKey=dt.codec.base64.fromBits(combinedKey),encryptedKey=t.encrypt_b64(encodedKey),prefix="$bt4|javascript_"+n.version.replace(/\./g,"_")+"$",prefix+encryptedKey+"$"+ciphertext+"$"+signature},n.encryptForm=function(e){var t,o,u,f,l,c,h;e=s(e),c=a(e);while(r.length>0)h=r[0].ownerDocument,h.contains&&h.contains(r[0])&&e.removeChild(r[0]),r.splice(0,1);for(l=0;l<c.length;l++)t=c[l],u=t.getAttribute("data-encrypted-name"),o=n.encrypt(t.value),t.removeAttribute("name"),f=i("input",{value:o,type:"hidden",name:u}),r.push(f),e.appendChild(f)},n.onSubmitEncryptForm=function(e,t){var r;e=s(e),r=function(r){return n.encryptForm(e),t?t(r):r},window.jQuery?window.jQuery(e).submit(r):e.addEventListener?e.addEventListener("submit",r,!1):e.attachEvent&&e.attachEvent("onsubmit",r)},n.formEncrypter={encryptForm:n.encryptForm,extractForm:s,onSubmitEncryptForm:n.onSubmitEncryptForm},dt.random.startCollectors()},window.Braintree=vt,typeof define=="function"&&define("braintree",[],function(){return vt})}(),define("text!tpl/CreditCardDetailsView.html",[],function(){return'<html>\n  <h2>Credit Card Details View</h2>\n\n\n <h3>Order Model details</h3>\n   <ul>\n     <li><b>_id: </b><%= _id %></li>\n     <li><b>gig_id: </b><%= gig_id %></li>\n     <li><b>main_event: </b><%= main_event %></li>\n     <li><b>event_date: </b><%= event_date %></li>\n     <li><b>venue: </b><%= venue %></li>\n     <li><b>opening_time: </b><%= opening_time %></li>\n     <li><b>age_group: </b><%= age_group %></li>\n     <li><b>user_id: </b><%= user_id %></li>\n     <li><b>user_authenticated: </b><%= user_authenticated %></li>\n     <li><b>braintree_customer_id: </b><%= braintree_customer_id %></li>\n     <li><b>number_of_tickets: </b><%= number_of_tickets %>\n     <li><b>ticket_price: </b><%= ticket_price %></li>\n     <li><b>transaction_amount: </b><%= transaction_amount %></li>\n     <li><b>transaction_id: </b><%= transaction_id %></li>\n     <li><b>transaction_status: </b><%= transaction_status %></li>\n   </ul>\n\n  <h4 >Time elapsed: <div id="ticker"></div></h4>\n\n  <h4>Total Amount $:  <%= ticket_price %> * <%= number_of_tickets %> = <div id="summary_total_amount"></div></h4>\n\n\n      <div>\n        <h3>Using model and collection idiom  to get at input rather than using a braintree form</h3>\n        <p>\n        <label>Card Number</label>\n        <input type="text" size="20" autocomplete="off" id="cc_number" data-encrypted-name="cc_number" />\n        </p>\n        <p>\n        <label>CVV</label>\n        <input type="text" size="4" autocomplete="off" id="cc_cvv" data-encrypted-name="cc_cvv" />\n        </p>\n        <p>\n        <label>Expiration (MM/YYYY)</label>\n        <input type="text" size="2" name="cc_month" id="cc_month"/> / <input type="text" size="4" name="cc_year" id="cc_year"/>\n      \n        </p>\n      </div>\n\n  <div id="submit" class="proceed">SUBMIT</div>\n\n</html>\n'}),define("text!tpl/CheckoutView.html",[],function(){return'<html>\n  <h2>CheckoutView</h2>\n\n  <!-- SHOULD ONLY SHOW THIS LINK TO PASS TO IPHONE/SAFARI/MOBILE USERS-->\n  <a href="/api/etix/pkpass/<%= gig_id %>" id="import_passbook_pass"><div>iPhone/Safari/Mobile: Import ticket to Passbook App</div></a>\n\n\n<!--\n    <p>SHOULD ONLY SHOW THIS LINK TO PASS TO ANDROID/CHROME/MOBILE USERS</p>\n    <a href="/api/electronic_tickets/google_wallet"><div id="import_android_wallet">Android/Chrome/Mobile:Import ticket to Google Wallet App (i have not implemented this yet)</div></a>\n-->\n\n  <h4>this.model values:</h4>\n\n  <ul>\n    <li><b>_id: </b><%= _id %></li>\n    <li><b>gig_id: </b><%= gig_id %></li>\n    <li><b>main_event: </b><%= main_event %></li>\n    <li><b>event_date: </b><%= event_date %></li>\n    <li><b>venue: </b><%= venue %></li>\n    <li><b>opening_time: </b><%= opening_time %></li>\n    <li><b>age_group: </b><%= age_group %></li>\n    <li><b>user_id: </b><%= user_id %></li>\n    <li><b>user_authenticated: </b><%= user_authenticated %></li>\n    <li><b>braintree_customer_id: </b><%= braintree_customer_id %></li>\n    <li><b>number_of_tickets: </b><%= number_of_tickets %>\n    <li><b>ticket_price: </b><%= ticket_price %></li>\n    <li><b>transaction_amount: </b><%= transaction_amount %></li>\n    <li><b>transaction_id: </b><%= transaction_id %></li>\n    <li><b>transaction_status: </b><%= transaction_status %></li>\n  </ul>\n\n</html>\n'}),define("views/checkout-view",["backbone","text!tpl/CheckoutView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"checkoutDetails",template:_.template(t),events:{"click #import_passbook_pass":"importPassbookPass"},initialize:function(){console.log("in initialize() of checkout-view.js"),console.log("is newOrder present? : "+JSON.stringify(this.model,null,4)),console.log("window.navigator.userAgent: "+window.navigator.userAgent),this.theUserAgent=this.findTheUserAgent(),console.log("theUserAgent is: "+this.theUserAgent),this.listenTo(this.model,"change",this.updateHandler)},render:function(){return console.log("in checkout-view.js and render()"),this.$el.html(this.template(this.model.toJSON())),this.theUserAgent==="iPhone/Safari/Mobile"&&(console.log("the user-agent is iPhone/Safari/Mobile. display pkpass link"),console.log(this.$el),console.log(this.$("#import_passbook_pass")),this.$("#import_passbook_pass").css("display","block")),this},updateHandler:function(){console.log("in updateHandler() since this.model emitted a 'change' event");if(this.model.get("transaction_status")==="submitted_for_settlement"&&this.model.get("user_authenticated")===!0){console.log("submitted_for_settlement and user __IS__ authorized."),this.render();return}switch(this.model.get("transaction_status")){case"authorized":console.log("switch block and transaction_status: authorized"),this.render();break;case"authorization_expired":console.log("switch block and transaction_status: authorization_expired"),this.render();break;case"processor_declined":console.log("switch block and transaction_status: processor_declined"),this.render();break;case"gateway_rejected":console.log("switch block and transaction_status: gateway_rejected"),this.render();break;case"failed":console.log("switch block and transaction_status: failed"),this.render();break;case"void":console.log("switch block and transaction_status: void"),this.render();break;case"submitted_for_settlement":console.log("switch block and transaction_status: submitted_for_settlement"),this.render();break;case"settling":console.log("switch block and transaction_status: settling"),this.render();break;case"settled":console.log("switch block and transaction_status: settled"),this.render();break;default:console.log("switch block and in default handler"),this.render()}return},findTheUserAgent:function(){var e=window.navigator.userAgent,t="";return e.search(/macintosh/i)!==-1&&e.search(/chrome/i)!==-1?t="Macintosh/Chrome":e.search(/macintosh/i)!==-1&&e.search(/firefox/i)!==-1?t="Macintosh/Firefox":e.search(/macintosh/i)!==-1&&e.search(/safari/i)!==-1?t="Macintosh/Safari":e.search(/iphone/i)!==-1&&e.search(/chrome/i)!==-1&&e.search(/mobile/i)!==-1?t="iPhone/Chrome/Mobile":e.search(/iphone/i)!==-1&&e.search(/firefox/i)!==-1&&e.search(/mobile/i)!==-1?t="iPhone/Firefox/Mobile":e.search(/iphone/i)!==-1&&e.search(/safari/i)!==-1&&e.search(/mobile/i)!==-1?t="iPhone/Safari/Mobile":e.search(/ipad/i)!==-1&&e.search(/chrome/i)!==-1&&e.search(/mobile/i)!==-1?t="iPad/Chrome/Mobile":e.search(/ipad/i)!==-1&&e.search(/firefox/i)!==-1&&e.search(/mobile/i)!==-1?t="iPad/Firefox/Mobile":e.search(/ipad/i)!==-1&&e.search(/safari/i)!==-1&&e.search(/mobile/i)!==-1?t="iPad/Safari/Mobile":t="unable_to_determine_user_agent_extracted",t},importPassbookPass:function(){console.log("in importPassbookPass handler")}});return n}),define("views/credit-card-details-view",["backbone","braintree","text!tpl/CreditCardDetailsView.html","views/checkout-view"],function(e,t,n,r){var i=e.View.extend({tagName:"div",className:"credit_card_details",template:_.template(n),events:{"keypress #cc_number":"cc_number_update","keypress #cc_cvv":"cc_cvv_update","keypress #cc_month":"cc_month_update","keypress #cc_year":"cc_year_update","blur #cc_number":"cc_number_blur","blur #cc_cvv":"cc_cvv_blur","blur #cc_month":"cc_month_blur","blur #cc_year":"cc_year_blur","click #submit":"submit"},initialize:function(){console.log("in initialize() of credit-card-details-view.js"),this.current_view=this,_.bindAll(this),this.braintree=t.create("MIIBCgKCAQEAwJo0HGLwcnHbj+LCBWEvxjjfZYTwoJuNvR34CevWwu71HeQ7s6kD9FuzK3nHFL0oA2/HchnhmWh4ilFzYq3/4U+hNLJwdG++MlZxQ9KlfLX2ROatmuOyIcD1mXKlKAEhuxU4OnTBnMByyzhy3Hz/9omOGWK0bjmSKkZabjwiqgs0E2VLeRaTERxWPPAKEPgKfiFjiYdOyYbXvvOtRU6kMze6ZoYnF098/RkrJuL8a+tn6otmQHJOvvLobJf0PYTH1YKEgx7JGhTQ0tvewd/gz4Lg8GMknM0HkGWaqtpLzeqahDGfik0PZQfWArvVQofOLVito0yY1Ck6G2A8mrjb/QIDAQAB"),console.log("braintree object:"),console.dir(this.braintree),this.start_reserve_tickets_countdown()},render:function(){console.log("in credit-card-details-view.js and render()"),this.$el.html(this.template(this.model.toJSON()));var e=this.model.get("number_of_tickets")*this.model.get("ticket_price");return this.$("#summary_total_amount").html(e),this.$cc_number=this.$("#cc_number"),this.$cc_cvv=this.$("#cc_cvv"),this.$cc_month=this.$("#cc_month"),this.$cc_year=this.$("#cc_year"),this},cc_number_update:function(e){console.log("cc_number");return},cc_cvv_update:function(e){console.log("cc_cvv");return},cc_month_update:function(e){console.log("cc_month");return},cc_year_update:function(e){console.log("cc_year");return},cc_number_blur:function(e){console.log("cc_number_blur"),this.close_input_field(this.$cc_number,"cc_number");return},cc_cvv_blur:function(e){console.log("cc_cvv_blur"),this.close_input_field(this.$cc_cvv,"cc_cvv");return},cc_month_blur:function(e){console.log("cc_month_blur"),this.close_input_field(this.$cc_month,"cc_month");return},cc_year_blur:function(e){console.log("cc_year_blur"),this.close_input_field(this.$cc_year,"cc_year");return},close_input_field:function(e,t){console.log("close_input_field()"),console.dir(e),console.log("model_attribute: "+t);var n={},r=e.val().trim(),i=this.braintree.encrypt(r);n[t]=i,this.model.set(n),console.log("value entered into field, "+t+" is "+r),console.log("encrpyted value of entered into field, "+t+" is "+i);return},submit:function(e){console.log("submitting cc details"),console.log("this.model: "),console.dir(this.model);var t=this;this.model.save({},{error:function(e,t){console.log("ERROR in saving/updating the model"),console.dir(e),console.dir(t)},success:function(e,n){console.log("SUCCESS in saving/updating the model"),console.dir(e),console.dir(n),t.handle_cc_statuses(n,e)}})},handle_cc_statuses:function(e,t){var n=e.transaction_status;if(n==="submitted_for_settlement"){console.log("transaction_status: "+n),clearInterval(this.interval_id);var i=new r({model:t});this.show_view("#featureContent",i)}else n==="authorized"?console.log("transaction_status: "+n):console.log("transaction_status: "+n)},start_reserve_tickets_countdown:function(){console.log("in start_reserve_tickets_coundown()"),this.poll=0,this.interval_id=setInterval(this.poller,1e3)},parse_cookie_string:function(){this.cookies_obj={},this.cookies_array=document.cookie.split(";");for(var e in this.cookies_array){var t=this.cookies_array[e].substring(0,this.cookies_array[e].indexOf("=")),n=this.cookies_array[e].substring(this.cookies_array[e].indexOf("=")+1);t=t.replace(/^\s+|\s+$/g,""),this.cookies_obj[t]=n}},poller:function(){this.parse_cookie_string();if(this.cookies_obj.reserve_tickets)this.poll++,this.$("#ticker").html(this.poll);else{console.log("ALONGSIDE YOUR HORSE, YOUR TICKET RESERVATION BOLTED OUT THE GATE."),clearInterval(this.interval_id);var e=this;$.ajax({url:"/api/orders/ticket_reserve_timeout",type:"POST",data:this.model.toJSON(),success:function(e,t,n){console.log("SUCCESS: deleted ticket reserve cookie"),console.dir(e),console.log(t),console.dir(n)},error:function(e,t,n){console.log("ERROR: trouble with deleting ticket reserve cookie"),console.dir(e),console.log(t),console.dir(n)}})}},show_view:function(e,t){return console.log("in showView of credit-card-details-view.js"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return i}),define("text!tpl/PurchaseWithCreditCardFromVaultView.html",[],function(){return'<html>\n  <h2>Purchase with Credit Card from Vault View</h2>\n\n\n <h3>Order Model details</h3>\n   <ul>\n     <li><b>_id: </b><%= _id %></li>\n     <li><b>gig_id: </b><%= gig_id %></li>\n     <li><b>main_event: </b><%= main_event %></li>\n     <li><b>event_date: </b><%= event_date %></li>\n     <li><b>venue: </b><%= venue %></li>\n     <li><b>opening_time: </b><%= opening_time %></li>\n     <li><b>age_group: </b><%= age_group %></li>\n     <li><b>user_id: </b><%= user_id %></li>\n     <li><b>user_authenticated: </b><%= user_authenticated %></li>\n     <li><b>braintree_customer_id: </b><%= braintree_customer_id %></li>\n     <li><b>number_of_tickets: </b><%= number_of_tickets %>\n     <li><b>ticket_price: </b><%= ticket_price %></li>\n     <li><b>transaction_amount: </b><%= transaction_amount %></li>\n     <li><b>transaction_id: </b><%= transaction_id %></li>\n     <li><b>transaction_status: </b><%= transaction_status %></li>\n   </ul>\n\n  <h4 >Time elapsed: <div id="ticker"></div></h4>\n\n  <h4>Total Amount $:  <%= ticket_price %> * <%= number_of_tickets %> = <div id="summary_total_amount"></div></h4>\n\n\n  <h3>Bill credit card: </h3>\n  <h5>Number: </h5><div id="cc_masked_number"></div>\n  <h5>Expiration: </h5><div id="cc_expiration_date"></div>\n\n\n\n  <div class="proceed" id="edit_cc_details">change default cc? </div>\n\n\n\n  <div id="enter_cc_details">\n    <p>\n    <label>Card Number</label>\n    <input type="text" size="20" autocomplete="off" id="cc_number" data-encrypted-name="cc_number" />\n     </p>\n     <p>\n     <label>CVV</label>\n     <input type="text" size="4" autocomplete="off" id="cc_cvv" data-encrypted-name="cc_cvv" />\n     </p>\n     <p>\n     <label>Expiration (MM/YYYY)</label>\n     <input type="text" size="2" name="cc_month" id="cc_month"/> / <input type="text" size="4" name="cc_year" id="cc_year"/>\n     </p>\n\n    <div id="submit_1" class="proceed">SUBMIT</div>\n  </div>\n\n\n  <div id="submit" class="proceed">SUBMIT</div>\n\n</html>\n'}),define("views/purchase-with-credit-card-from-vault-view",["backbone","braintree","text!tpl/PurchaseWithCreditCardFromVaultView.html","views/checkout-view","views/credit-card-details-view"],function(e,t,n,r,i){var s=e.View.extend({tagName:"div",className:"purchase_with_credit_card_details_from_vault_details",template:_.template(n),events:{"keypress #cc_number":"cc_number_update","keypress #cc_cvv":"cc_cvv_update","keypress #cc_month":"cc_month_update","keypress #cc_year":"cc_year_update","blur #cc_number":"cc_number_blur","blur #cc_cvv":"cc_cvv_blur","blur #cc_month":"cc_month_blur","blur #cc_year":"cc_year_blur","click #submit":"submit","click #edit_cc_details":"edit_cc_details","click #submit_1":"submit_1"},initialize:function(){console.log("in initialize() of purchase-with-credit-card-from-vault-view.js"),this.current_view=this,this.new_cc_details={},_.bindAll(this),this.braintree=t.create("MIIBCgKCAQEAwJo0HGLwcnHbj+LCBWEvxjjfZYTwoJuNvR34CevWwu71HeQ7s6kD9FuzK3nHFL0oA2/HchnhmWh4ilFzYq3/4U+hNLJwdG++MlZxQ9KlfLX2ROatmuOyIcD1mXKlKAEhuxU4OnTBnMByyzhy3Hz/9omOGWK0bjmSKkZabjwiqgs0E2VLeRaTERxWPPAKEPgKfiFjiYdOyYbXvvOtRU6kMze6ZoYnF098/RkrJuL8a+tn6otmQHJOvvLobJf0PYTH1YKEgx7JGhTQ0tvewd/gz4Lg8GMknM0HkGWaqtpLzeqahDGfik0PZQfWArvVQofOLVito0yY1Ck6G2A8mrjb/QIDAQAB"),console.log("braintree object:"),console.dir(this.braintree),this.start_reserve_tickets_countdown()},render:function(){console.log("in purchase-with-credit-card-from-vault-view.js and render()"),this.$el.html(this.template(this.model.toJSON())),this.$("#enter_cc_details").css("display","none");var e=this.model.get("number_of_tickets")*this.model.get("ticket_price");return this.$("#summary_total_amount").html(e),this.$cc_number=this.$("#cc_number"),this.$cc_cvv=this.$("#cc_cvv"),this.$cc_month=this.$("#cc_month"),this.$cc_year=this.$("#cc_year"),$.ajax({url:"/api/users/account/billing_info/",type:"GET",success:function(e,t,n){console.log("SUCCESS: user cc details: "),console.dir(e),console.log(t),console.dir(n),self.$("#cc_masked_number").html(e.masked_number),self.$("#cc_expiration_date").html(e.expiration_date)},error:function(e,t,n){console.log("ERROR: user cc details: "),console.dir(e),console.log(t),console.dir(n)}}),this},cc_number_update:function(e){console.log("cc_number");return},cc_cvv_update:function(e){console.log("cc_cvv");return},cc_month_update:function(e){console.log("cc_month");return},cc_year_update:function(e){console.log("cc_year");return},cc_number_blur:function(e){console.log("cc_number_blur"),this.close_input_field(this.$cc_number,"cc_number");return},cc_cvv_blur:function(e){console.log("cc_cvv_blur"),this.close_input_field(this.$cc_cvv,"cc_cvv");return},cc_month_blur:function(e){console.log("cc_month_blur"),this.close_input_field(this.$cc_month,"cc_month");return},cc_year_blur:function(e){console.log("cc_year_blur"),this.close_input_field(this.$cc_year,"cc_year");return},close_input_field:function(e,t){console.log("close_input_field()"),console.dir(e),console.log("model_attribute: "+t);var n={},r=e.val().trim(),i=this.braintree.encrypt(r);n[t]=i,this.model.set(n),this.new_cc_details[t]=i,console.log("value entered into field, "+t+" is "+r),console.log("encrpyted value of entered into field, "+t+" is "+i);return},submit:function(){console.log("submitting cc details"),console.log("this.model: "),console.dir(this.model);var e=this;this.model.save({},{error:function(e,t){console.log("ERROR in saving/updating the model"),console.dir(e),console.dir(t)},success:function(t,n){console.log("SUCCESS in saving/updating the model"),console.dir(t),console.dir(n),e.handle_cc_statuses(n,t)}})},handle_cc_statuses:function(e,t){var n=e.transaction_status;if(n==="submitted_for_settlement"){console.log("transaction_status: "+n),clearInterval(this.interval_id);var i=new r({model:t});this.show_view("#featureContent",i)}else n==="authorized"?console.log("transaction_status: "+n):console.log("transaction_status: "+n)},edit_cc_details:function(){this.$("#submit").css("display","none"),this.$("#enter_cc_details").css("display","block")},submit_1:function(){console.log("you just clicked submit_1 div");var e=this;$.ajax({url:"/api/users/change_cc_details/",type:"POST",data:e.new_cc_details,success:function(t,n,r){console.log("SUCCESS: changed the cc details for the user"),console.dir(t),console.log(n),console.dir(r),e.model.set({braintree_customer_id:t.customer.id}),e.submit()},error:function(e,t,n){console.log("ERROR: could not change the cc details for the user"),console.dir(e),console.log(t),console.dir(n)}})},start_reserve_tickets_countdown:function(){console.log("in start_reserve_tickets_coundown()"),console.log("document.cookie: "+document.cookie),this.poll=0,this.interval_id=setInterval(this.poller,1e3)},parse_cookie_string:function(){this.cookies_obj={},this.cookies_array=document.cookie.split(";");for(var e in this.cookies_array){var t=this.cookies_array[e].substring(0,this.cookies_array[e].indexOf("=")),n=this.cookies_array[e].substring(this.cookies_array[e].indexOf("=")+1);t=t.replace(/^\s+|\s+$/g,""),this.cookies_obj[t]=n}},poller:function(){this.parse_cookie_string();if(this.cookies_obj.reserve_tickets)this.poll++,this.$("#ticker").html(this.poll);else{console.log("ALONGSIDE YOUR HORSE, YOUR TICKET RESERVATION BOLTED OUT THE GATE."),clearInterval(this.interval_id);var e=this;$.ajax({url:"/api/orders/ticket_reserve_timeout",type:"POST",data:this.model.toJSON(),success:function(e,t,n){console.log("SUCCESS: deleted ticket reserve cookie"),console.dir(e),console.log(t),console.dir(n)},error:function(e,t,n){console.log("ERROR: trouble with deleting ticket reserve cookie"),console.dir(e),console.log(t),console.dir(n)}})}},show_view:function(e,t){return console.log("in showView of credit-card-details-view.js"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return s}),define("views/number-of-tickets-view",["backbone","text!tpl/NumberOfTicketsView.html","models/order-model","collections/ordersCollection","views/credit-card-details-view","views/checkout-view","views/purchase-with-credit-card-from-vault-view"],function(e,t,n,r,i,s,o){var u=e.View.extend({tagName:"div",className:"number_of_tickets_details",template:_.template(t),events:{"click #ticket_amount_one":"one_ticket","click #ticket_amount_two":"two_tickets","click #ticket_amount_three":"three_tickets","click #ticket_amount_four":"four_tickets","click #ticket_amount_five":"five_tickets","click #ticket_amount_six":"six_tickets","click #ticket_amount_seven":"seven_tickets","click #ticket_amount_eight":"eight_tickets","click #submit":"submit"},initialize:function(){console.log("in initialize() of number-of-tickets-view.js"),console.log("this.model: "+JSON.stringify(this.model)),this.number_of_tickets=0,this.total_amount=0,this.tmp_model={},console.log("this.options");for(var e in this.options)console.log(this.options[e])},render:function(){return console.log("in number-of-tickets-view.js and render()"),this.$el.html(this.template(this.model.toJSON())),this.current_view=this,this},one_ticket:function(){this.number_of_tickets=1,this.calculate_total_and_display()},two_tickets:function(){this.number_of_tickets=2,this.calculate_total_and_display()},three_tickets:function(){this.number_of_tickets=3,this.calculate_total_and_display()},four_tickets:function(){this.number_of_tickets=4,this.calculate_total_and_display()},five_tickets:function(){this.number_of_tickets=5,this.calculate_total_and_display()},six_tickets:function(){this.number_of_tickets=6,this.calculate_total_and_display()},seven_tickets:function(){this.number_of_tickets=7,this.calculate_total_and_display()},eight_tickets:function(){this.number_of_tickets=8,this.calculate_total_and_display()},calculate_total_and_display:function(){this.total_amount=this.number_of_tickets*this.model.get("price"),this.model.set({number_of_tickets:self.number_of_tickets}),console.log("Total price for "+this.number_of_tickets+" is: "+this.total_amount),this.$("#total_amount").html(this.total_amount);return},submit:function(){console.log("clicked proceed to payment button");var e=this;this.new_order||(this.new_order=new n),this.new_order.set({gig_id:e.model.get("_id"),ticket_price:e.model.get("price"),number_of_tickets:e.number_of_tickets,transaction_amount:e.total_amount}),this.orders_collection||(this.orders_collection=new r),this.orders_collection.add(this.new_order),this.new_order.save({},{success:function(t,n){console.log("SUCCESS: saved the new_order for the first time."),console.dir(t),console.dir(n);if(n.error)console.log("response.first_time_purchaser returned NOT as expected"),alert("ERROR: "+n.error),console.log(e.new_order),e.render();else if(n.braintree_customer_id==="default_braintree_customer_id"){console.dir(e.new_order);var r=new i({model:e.new_order});e.show_view("#featureContent",r)}else if(n.braintree_customer_id!=="default_braintree_customer_id"){var s=new o({model:e.new_order});e.show_view("#featureContent",s)}else console.log("hit the bottom of if logic, uh oh"),e.render()},error:function(t,n){console.log("ERROR: could not save the new_order for the first time."),console.dir(t),console.dir(n),alert("ERROR: could not save the new_order model."),e.render()}})},show_view:function(e,t){return console.log("in showView of number-of-tickets-view.js"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return u}),define("text!tpl/LoginWithGigDetailsView.html",[],function(){return'<html>\n  <div>\n    <h3>User Login View: WITH A GIG DETAILS</h3>\n\n\n    <div>\n      <div class="proceed" id="register">Don\'t have an account? Register now</div>\n\n      <p>\n\n      <h5>User Account Login</h5>\n      <label>Email Address</label>\n      <input type="text" size="30" autocomplete="off" id="email_address" name="email_address" />\n      </p>\n\n      <p>\n      <label>Password</label>\n      <input type="password" size="30" id="password" name="password" />\n      </p>\n\n      <div id="login" class="proceed" >LOGIN</div>\n\n  </div>\n</html>\n'}),define("text!tpl/RegisterWithGigDetailsView.html",[],function(){return'<html>\n  <div>\n    <h3>Register a new User Account. </h3>\n   \n    <h5>the View has the gig details as this.model</h5>\n\n    <label>First Name</label>\n    <input type="text" id="first_name" />\n\n    <label>Last Name</label>\n    <input type="text" id="last_name" />\n\n    <label>Phone Number</label>\n    <input type="text" id="phone_number" />\n\n    <label>Email</label>\n    <input type="text" id="email_address"/>\n\n    <label>Password</label>\n    <input type="password" id="password"/></br>\n\n   <div id="register" class="proceed">REGISTER</div>\n\n  </div>\n</html>\n'}),define("models/user-model",["backbone"],function(){var e=Backbone.Model.extend({idAttribute:"_id",urlRoot:function(){return this.isNew()&&(console.log("user model is considered new i.e. thinks id has no been set."),console.log("in user-model.js and urlRoot: /api/users/"+this.id)),console.log("in user-model.js and urlRoot: /api/users/"+this.id),"/api/users/"},defaults:{first_name:"backbone_default_first_name",last_name:"backbone_default_last_name",email_address:"backbone_default_email_address",phone_number:"backbone_default_phone_number",braintree_customer_id:"backbone_default_braintree_customer_id"}});return e}),define("views/register-with-gig-details-view",["backbone","text!tpl/RegisterWithGigDetailsView.html","models/user-model","views/number-of-tickets-view"],function(e,t,n,r){var i=e.View.extend({tagName:"div",className:"register_with_gig_details",template:_.template(t),events:{"keypress #first_name":"first_name_keypress","keypress #last_name":"last_name_keypress","keypress #phone_number":"phone_number_keypress","keypress #email_address":"email_address_keypress","keypress #password":"password_keypress","blur #first_name":"first_name_blur","blur #last_name":"last_name_blur","blur #phone_number":"phone_number_blur","blur #email_address":"email_address_blur","blur #password":"password_blur","click #register":"register"},initialize:function(){console.log("in initialize() of register-with-gig-details-view.js"),console.dir(this.model),this.current_view=this},render:function(){return console.log("in register-with-gig-details-view.js and render()"),this.$el.html(this.template(this.model.toJSON())),this.$first_name=this.$("#first_name"),this.$last_name=this.$("#last_name"),this.$phone_number=this.$("#phone_number"),this.$email_address=this.$("#email_address"),this.$password=this.$("#password"),this.registration_details={},this},first_name_keypress:function(e){console.log("in first_name_keypress");return},last_name_keypress:function(e){console.log("in last_name_keypress");return},phone_number_keypress:function(e){console.log("in phone_number_keypress");return},email_address_keypress:function(e){console.log("in email_address_keypress");return},password_keypress:function(e){console.log("in password_keypress");return},first_name_blur:function(e){console.log("in first_name_blur"),this.close_input_field(this.$first_name,"first_name");return},last_name_blur:function(e){console.log("in last_name_blur"),this.close_input_field(this.$last_name,"last_name");return},phone_number_blur:function(e){console.log("in phone_number_blur"),this.close_input_field(this.$phone_number,"phone_number");return},email_address_blur:function(e){console.log("in email_address_blur"),this.close_input_field(this.$email_address,"email_address");return},password_blur:function(e){console.log("in password_blur"),this.close_input_field(this.$password,"password");return},close_input_field:function(e,t){console.log("in close_input_field"),console.dir(e),console.log("attribute: "+t);var n=e.val().trim();this.registration_details[t]=n;return},register:function(){console.log("in register function");var e=this;$.ajax({url:"/api/users/register",type:"POST",data:e.registration_details,success:function(t,n,i){console.log("SUCCESS: in ajax request"),console.dir(t),console.log(n),console.dir(i);if(t.errors)alert("ASSERTION ERRORS: invalid user input"),console.log("ASSERTION ERRORS: invalid user input"),console.dir(t);else if(t.registration_success===!0){console.log("SUCCESS: registration success."),e.switch_log_button("#logout_header","#login_header");var s=new r({model:e.model});e.show_view("#featureContent",s),e.display_account_tab(!0)}else console.log("POST /api/users/register did NOT return registration_success === true"),console.log("ERROR in registration:"),console.dir(t),e.render()},error:function(e,t,n){console.log("ERROR: registration success."),console.dir(e),console.log(t),console.dir(n)}})},switch_log_button:function(e,t){$(t).css("display","none"),$(e).css("display","block")},display_account_tab:function(e){e?$("#account").css("display","block"):$("#account").css("display","none")},show_view:function(e,t){return console.log("in show_view()"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return i}),define("views/login-with-gig-details-view",["backbone","text!tpl/LoginWithGigDetailsView.html","views/number-of-tickets-view","views/register-with-gig-details-view"],function(e,t,n,r){var i=e.View.extend({tagName:"div",className:"login_with_gig_details",template:_.template(t),events:{"keypress #email_address":"email_address_keypress","keypress #password":"password_keypress","blur #email_address":"email_address_blur","blur #password":"password_blur","click #login":"login","click #register":"register"},initialize:function(){console.log("in initialize() of login-with-gig-details-view.js"),console.dir(this.model)},render:function(){return console.log("in login-with-gig-details-view.js and render()"),this.$el.html(this.template(this.model.toJSON())),this.$email_address=this.$("#email_address"),this.$password=this.$("#password"),this.login_details={},this},email_address_keypress:function(e){console.log("in email_address_keypress");return},password_keypress:function(e){console.log("in password_keypress");return},email_address_blur:function(e){console.log("in email_address_blur"),this.close_input_field(this.$email_address,"email_address");return},password_blur:function(e){console.log("in password_blur"),this.close_input_field(this.$password,"password");return},close_input_field:function(e,t){console.log("in close_input_field"),console.dir(e),console.log("attribute: "+t);var n=e.val().trim();this.login_details[t]=n,console.log("value entered into the attribute, "+t+", is "+n),console.dir(this.login_details);return},login:function(){console.log("in login function");var e=this;$.ajax({url:"/api/users/login",type:"POST",data:e.login_details,success:function(t,r,i){console.log("SUCCESS: POST /api/users/login"),console.dir(t),console.log(r),console.dir(i);if(t.errors)alert("ASSERTION ERROR: invalid user input"),console.log("ASSERTION ERROR: invalid user input"),console.dir(t.errors),e.render();else if(t.user_authenticated){e.current_view=e;var s=new n({model:e.model});e.show_view("#featureContent",s),e.switch_log_button("#logout_header","#login_header"),e.display_account_tab(!0)}else console.log("login failed, try again"),console.dir(t),e.render()},error:function(e,t,n){console.log("ERROR: POST /api/users/login"),console.dir(e),console.log(t),console.dir(n)}})},register:function(){console.log("in register function");var e=this,t=new r({model:e.model});this.show_view("#featureContent",t)},switch_log_button:function(e,t){$(t).css("display","none"),$(e).css("display","block")},show_view:function(e,t){return console.log("in show_view()"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t},display_account_tab:function(e){e?$("#account").css("display","block"):$("#account").css("display","none")}});return i}),define("views/gig-detail-view",["backbone","text!tpl/GigDetails.html","./number-of-tickets-view","models/order-model","collections/ordersCollection","views/login-with-gig-details-view"],function(e,t,n,r,i,s){var o=e.View.extend({tagName:"div",className:"gigDetails",template:_.template(t),events:{"click #get_tickets":"getTickets"},initialize:function(){console.log("in initialize() of gig-detail-view.js"),console.log("this.options: ");for(var e in this.options)console.log(this.options[e])},render:function(){return console.log("in gig-detail-view.js and render()"),this.$el.html(this.template(this.model.toJSON())),console.log("this.model: "),console.dir(this.model),this.currentView=this,this},getTickets:function(){console.log("in getTickets click handler.");var e=this;$.ajax({url:"/api/users/session",type:"GET",success:function(t,r,i){console.log("SUCCESS: got $.ajax GET /api/users/session"),console.dir(t),console.log("textStatus: "+r),console.dir(i);if(!t.user_authenticated){var o=new s({model:e.model});e.showView("#featureContent",o)}else if(t.user_authenticated===!0){var u=new n({model:e.model});e.showView("#featureContent",u)}},error:function(e,t,n){console.log("ERROR: tried to $.ajax GET /api/users/session"),console.dir(e),console.log("textStatus: "+t),console.log("errorThrown: "+n)}})},showView:function(e,t){return console.log("in showView in gig-detail-view.js"),this.currentView&&this.currentView.close(),$(e).html(t.render().el),this.currentView=t,t}});return o}),define("views/gig-list-item-view",["backbone","text!tpl/GigListItemView.html","views/gig-detail-view"],function(e,t,n){var r=e.View.extend({tagName:"li",className:"gigListItemContainer",template:_.template(t),events:{click:"clickedGig"},initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.close,this)},render:function(){return console.log("in GigListItemView render()"),this.$el.html(this.template(this.model.toJSON())),this},clickedGig:function(e){console.log("a gig list item, clicked NAME : "+this.model.get("mainEvent"));var t=new n({model:this.model});$("#featureContent").html(t.render().el)}});return r}),define("models/gig-model",["backbone"],function(){var e=Backbone.Model.extend({idAttribute:"_id",defaults:{mainEvent:"No title",eventDate:"TBC",openingTime:"8:00 pm",venue:"TBC",price:"TBC",supports:"Not supplied",ageGroup:"TBC",description:"No description supplied.",tagNames:"No tags supplied",imageUrl:"http://d11x7re0mdurt0.cloudfront.net/img/placekitten_400x300.jpg"}});return e}),define("collections/gigGuide",["backbone","models/gig-model"],function(e,t){var n=e.Collection.extend({model:t,url:"/api/gigs"});return n}),define("text!tpl/GigGuideLandingView.html",[],function(){return"<html>\n  <div>\n    <h3>Gig Guide LANDING page</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  lkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjldasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjlad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/gig-guide-landing-view",["backbone","text!tpl/GigGuideLandingView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"gigDetails",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of gig-guide-landing-view.js"),this.on("close-default-landing-page",function(){console.log("HELLO FROM gig-guide-landing-view.js")})},render:function(){return console.log("in gig-guide-landing-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("views/gigs-view",["backbone","views/gig-list-item-view","collections/gigGuide","views/gig-guide-landing-view"],function(e,t,n,r){return GigsView=e.View.extend({tagName:"ul",events:{},initialize:function(){console.log("in intialize in views/gigs-view.js")},render:function(){return console.log("in render() of gigs-view.js"),_.each(this.model.models,function(e){this.renderGigListItem(e)},this),this},renderGigListItem:function(e){var n=new t({model:e});this.$el.append(n.render().el)}}),GigsView}),define("text!tpl/AboutView.html",[],function(){return"<html>\n  <div>\n    <h3>About Shackleton Ticketing</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  lkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjldasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjlad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/about-view",["backbone","text!tpl/AboutView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"about_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of about-view.js")},render:function(){return console.log("in about-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("text!tpl/ContactView.html",[],function(){return"<html>\n  <div>\n    <h3>Contact</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  l\nkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjld\nasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjl\nad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/contact-view",["backbone","text!tpl/ContactView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"contact_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of contact-view.js")},render:function(){return console.log("in contact-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("text!tpl/LoginView.html",[],function(){return'<html>\n  <div>\n    <h3>User Login View: for without a pending order</h3>\n   \n    <p>dont have an account?</p>\n    <div id="register" class="proceed">REGISTER</div>\n\n    <label>Email Address</label>\n    <input type="text" id="email_address"/>\n    <label>Password</label>\n    <input type="password" id="password"/>\n    \n    <div id="login" class="proceed">LOGIN</div>\n  </div>\n</html>\n'}),define("text!tpl/RegisterView.html",[],function(){return'<html>\n  <div>\n    <h3>Register a new User Account. </h3>\n   \n    <label>First Name</label>\n    <input type="text" id="first_name" />\n\n    <label>Last Name</label>\n    <input type="text" id="last_name" />\n\n    <label>Phone Number</label>\n    <input type="text" id="phone_number" />\n\n    <label>Email</label>\n    <input type="text" id="email_address"/>\n\n    <label>Password</label>\n    <input type="password" id="password"/></br>\n\n   <div id="register" class="proceed">REGISTER</div>\n\n  </div>\n</html>\n'}),define("text!tpl/SuccessfulRegistration.html",[],function(){return"<html>\n  <h2>Successful Registration</h2>\n  <p>Welcome to Shackleton Tickets</p>\n  <div>you can now go on to browse through tickets and purchase them.</div>\n</html>\n"}),define("views/successful-registration-view",["backbone","text!tpl/SuccessfulRegistration.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"successful_registration_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of successful-registration-view.js"),this.switch_log_button("#logout_header","#login_header")},render:function(){return console.log("in successful-registration-view.js and render()"),this.$el.html(this.template()),this},switch_log_button:function(e,t){$(t).css("display","none"),$(e).css("display","block")}});return n}),define("views/register-view",["backbone","text!tpl/RegisterView.html","views/successful-registration-view","models/user-model"],function(e,t,n,r){var i=e.View.extend({tagName:"div",className:"registerDetails",template:_.template(t),events:{"keypress #first_name":"first_name_keypress","keypress #last_name":"last_name_keypress","keypress #phone_number":"phone_number_keypress","keypress #email_address":"email_address_keypress","keypress #password":"password_keypress","blur #first_name":"first_name_blur","blur #last_name":"last_name_blur","blur #phone_number":"phone_number_blur","blur #email_address":"email_address_blur","blur #password":"password_blur","click #register":"register"},initialize:function(){console.log("in initialize() of register-view.js"),this.current_view=this},render:function(){return console.log("in register-view.js and render()"),this.$el.html(this.template()),this.$first_name=this.$("#first_name"),this.$last_name=this.$("#last_name"),this.$phone_number=this.$("#phone_number"),this.$email_address=this.$("#email_address"),this.$password=this.$("#password"),this.registration_details={},this},first_name_keypress:function(e){console.log("in first_name_keypress");return},last_name_keypress:function(e){console.log("in last_name_keypress");return},phone_number_keypress:function(e){console.log("in phone_number_keypress");return},email_address_keypress:function(e){console.log("in email_address_keypress");return},password_keypress:function(e){console.log("in password_keypress");return},first_name_blur:function(e){console.log("in first_name_blur"),this.close_input_field(this.$first_name,"first_name");return},last_name_blur:function(e){console.log("in last_name_blur"),this.close_input_field(this.$last_name,"last_name");return},phone_number_blur:function(e){console.log("in phone_number_blur"),this.close_input_field(this.$phone_number,"phone_number");return},email_address_blur:function(e){console.log("in email_address_blur"),this.close_input_field(this.$email_address,"email_address");return},password_blur:function(e){console.log("in password_blur"),this.close_input_field(this.$password,"password");return},close_input_field:function(e,t){console.log("in close_input_field"),console.dir(e),console.log("attribute: "+t);var n=e.val().trim();this.registration_details[t]=n;return},register:function(){console.log("in register function");var e=this;$.ajax({url:"/api/users/register",type:"POST",data:e.registration_details,success:function(t,r,i){console.log("SUCCESS: in ajax request"),console.dir(t),console.log(r),console.dir(i);if(t.registration_success===!0){console.log("SUCCESS: registration success.");var s=new n;e.show_view("#featureContent",s),e.display_account_tab(!0)}else console.log("POST /api/users/register did NOT return registration_success === true"),console.log(t),e.render()},error:function(e,t,n){console.log("ERROR: registration success."),console.dir(e),console.log(t),console.dir(n)}})},display_account_tab:function(e){e?$("#account").css("display","block"):$("#account").css("display","none")},show_view:function(e,t){return console.log("in show_view()"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return i}),define("text!tpl/UserDetails.html",[],function(){return"<html>\n  <h2>User Account Details</h2>\n  <ul>\n    <li><b>First Name: </b><%= first_name %></li>\n    <li><b>Last Name: </b><%= last_name %></li>\n    <li><b>Email Address: </b><%= email_address %></li>\n    <li><b>Phone Number: </b><%= phone_number %></li>\n    <li><b>Braintree Customer Id: </b><%= braintree_customer_id %></li>\n  </ul>\n</html>\n"}),define("views/user-details-view",["backbone","text!tpl/UserDetails.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"userDetails",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of user-details-view.js"),this.current_view=this},render:function(){return console.log("in user-details-view.js and render()"),this.$el.html(this.template(this.model.toJSON())),this},show_view:function(e,t){return console.log("in show_view()"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return n}),define("views/login-view",["backbone","text!tpl/LoginView.html","views/register-view","views/user-details-view","models/user-model"],function(e,t,n,r,i){var s=e.View.extend({tagName:"div",className:"login_details",template:_.template(t),events:{"keypress #email_address":"email_address_update","keypress #password":"password_update","blur #email_address":"email_address_blur","blur #password":"password_blur","click #login":"login","click #register":"register"},initialize:function(){console.log("in initialize() of login-view.js")},render:function(){return console.log("in login-view.js and render()"),this.$el.html(this.template()),this.$email_address=this.$("#email_address"),this.$password=this.$("#password"),console.dir(this.$email_address),console.dir(this.$password),console.dir(this),this.field_to_set={},this},email_address_update:function(e){console.log("email_address_update")},password_update:function(e){console.log("password_update")},email_address_blur:function(e){console.log("email_address_blur"),this.close_input_field(this.$email_address,"email_address");return},password_blur:function(e){console.log("password_blur"),this.close_input_field(this.$password,"password");return},close_input_field:function(e,t){console.log("close_input_field"),console.dir(e),console.log("model_attribute: "+t);var n=e.val().trim();this.field_to_set[t]=n,console.dir(this.field_to_set)},login:function(e){console.log("in login event handler"),console.dir(this.field_to_set);var t=this;$.ajax({url:"/api/users/login",type:"POST",data:t.field_to_set,success:function(e,n,s){console.log("SUCCESS: POST /api/users/login"),console.dir(e),console.log(n),console.dir(s);if(e.user_authenticated){t.switch_log_button("#logout_header","#login_header"),t.display_account_tab(!0);var o=new i({_id:e.user_id});o.fetch({success:function(e,n){console.log("SUCCESS: fetched the user model"),console.dir(e),console.log(n);var i=new r({model:e});t.show_view("#featureContent",i)},error:function(e,t){console.log("ERROR: in fetching the user model"),console.dir(e),console.log(t)}})}else console.log("LOGIN FAILED, TRY AGAIN"),console.log(e),t.render()},error:function(e,t,n){console.log("ERROR: POST /api/users/login"),console.dir(e),console.log(t),console.dir(n)}})},register:function(e){console.log("in register event handler");var t=new n;this.show_view("#featureContent",t)},switch_log_button:function(e,t){$(t).css("display","none"),$(e).css("display","block")},show_view:function(e,t){return console.log("in show_view()"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t},display_account_tab:function(e){e?$("#account").css("display","block"):$("#account").css("display","none")}});return s}),define("text!tpl/HomeLandingView.html",[],function(){return"<html>\n  <div>\n    <h3>***MAIN/HOME***  LANDING page</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  lkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjldasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjlad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/home-landing-view",["backbone","text!tpl/HomeLandingView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"home_landing_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of home-landing-view.js")},render:function(){return console.log("in home -landing-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("text!tpl/LoggedOutView.html",[],function(){return"<html>\n  <h2>Logged Out View</h2>\n  <p>Yes, you have been successfully logged out. thankyou, please come again.</p>\n</html>\n"}),define("views/logged-out-view",["backbone","text!tpl/LoggedOutView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"logged_out_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of logged-out-view.js")},render:function(){return console.log("in logged-out-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("text!tpl/AccountView.html",[],function(){return'<html>\n    <h3>ACCOUNT DETAILS</h3>\n\n  <aside id="account_sidebar">\n    <div id="account_orders">ORDERS</div>\n    <div id="account_billing">BILLING</div>\n    <div id="account_settings">SETTINGS</div>\n  </aside>\n\n  <div id="account_main">blah blah blah</div>\n\n\n</html>\n'}),define("text!tpl/OrderListItemView.html",[],function(){return'<html>\n  <div id="account_order">\n\n    <br>\n\n    <ul>\n      <li><b>_id: </b><%= _id %></li>\n      <li><b>gig_id: </b><%= gig_id %></li>\n      <li><b>main_event: </b><%= main_event %></li>\n      <li><b>event_date: </b><%= event_date %></li>\n      <li><b>venue: </b><%= venue %></li>\n      <li><b>opening_time: </b><%= opening_time %></li>\n      <li><b>age_group: </b><%= age_group %></li>\n      <li><b>user_id: </b><%= user_id %></li>\n      <li><b>user_authenticated: </b><%= user_authenticated %></li>\n      <li><b>number_of_tickets: </b><%= number_of_tickets %></li>\n      <li><b>ticket_price: </b><%= ticket_price %></li>\n      <li><b>transaction_amount: </b><%= transaction_amount %></li>\n      <li><b>transaction_id: </b><%= transaction_id %></li>\n      <li><b>transaction_status: </b><%= transaction_status %></li>\n      <li><b>braintree_customer_id: </b><%= braintree_customer_id %></li>\n    </ul>\n\n    <br>\n\n  </div>\n</html>\n\n'}),define("views/order-list-item-view",["backbone","text!tpl/OrderListItemView.html"],function(e,t){var n=e.View.extend({tagName:"li",className:"order_list_item_container",template:_.template(t),initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.close,this)},render:function(){return console.log("in OrderListItemView render()"),this.$el.html(this.template(this.model.toJSON())),this}});return n}),define("views/account-orders-view",["backbone","views/order-list-item-view","collections/ordersCollection"],function(e,t,n){return OrdersView=e.View.extend({tagName:"ul",events:{},initialize:function(){console.log("in intialize in account-orders-view.js")},render:function(){return console.log("in render() of account-orders-view.js"),_.each(this.model.models,function(e){this.render_order_list_item(e)},this),this},render_order_list_item:function(e){console.log("in render_order_list_item() of account-orders-view.js");var n=new t({model:e});this.$el.append(n.render().el)}}),OrdersView}),define("text!tpl/AccountBilling.html",[],function(){return'<html>\n  <h3>User Account: Billing Details</h3>\n\n  <div id="credit_card">\n    <b>Credit Card:</b>\n    <div id="masked_number"><b>Masked Number: </b><%= masked_number %></div>\n    <div id="last_4"><b>Last4: </b><%= last_4  %></div>\n    <div id="expiration_date"><b>Expiration Date: </b><%= expiration_date %></div>\n  </div>\n\n  <div class="proceed" id="change_cc">CHANGE CC DETAILS</div>\n\n\n  <div id="enter_new_cc_details">\n    <h3>Enter details to change your credit card.</h3>\n    <p>\n    <label>Card Number</label>\n    <input type="text" size="20" autocomplete="off" id="cc_number" data-encrypted-name\n="cc_number" />\n    </p>\n    <p>\n    <label>CVV</label>\n    <input type="text" size="4" autocomplete="off" id="cc_cvv" data-encrypted-name="cc\n_cvv" />\n    </p>\n    <p>\n    <label>Expiration (MM/YYYY)</label>\n    <input type="text" size="2" name="cc_month" id="cc_month"/> / <input type="text" s\nize="4" name="cc_year" id="cc_year"/>\n    </p>\n  \n    <div id="submit" class="proceed">SUBMIT</div>\n\n  </div>\n\n</html>\n'}),define("views/account-billing-view",["backbone","text!tpl/AccountBilling.html","braintree"],function(e,t,n){var r=e.View.extend({tagName:"div",className:"account_billing_details",template:_.template(t),events:{"keypress #cc_number":"cc_number_update","keypress #cc_cvv":"cc_cvv_update","keypress #cc_month":"cc_month_update","keypress #cc_year":"cc_year_update","blur #cc_number":"cc_number_blur","blur #cc_cvv":"cc_cvv_blur","blur #cc_month":"cc_month_blur","blur #cc_year":"cc_year_blur","click #change_cc":"change_cc","click #submit":"submit"},initialize:function(){console.log("in initialize() of account-billing-view.js"),this.current_view=this,console.log("options:"),console.dir(this.options),this.braintree=n.create("MIIBCgKCAQEAwJo0HGLwcnHbj+LCBWEvxjjfZYTwoJuNvR34CevWwu71HeQ7s6kD9FuzK3nHFL0oA2/HchnhmWh4ilFzYq3/4U+hNLJwdG++MlZxQ9KlfLX2ROatmuOyIcD1mXKlKAEhuxU4OnTBnMByyzhy3Hz/9omOGWK0bjmSKkZabjwiqgs0E2VLeRaTERxWPPAKEPgKfiFjiYdOyYbXvvOtRU6kMze6ZoYnF098/RkrJuL8a+tn6otmQHJOvvLobJf0PYTH1YKEgx7JGhTQ0tvewd/gz4Lg8GMknM0HkGWaqtpLzeqahDGfik0PZQfWArvVQofOLVito0yY1Ck6G2A8mrjb/QIDAQAB"),console.log("braintree object"),console.dir(this.braintree),this.field_to_set={}},render:function(){return console.log("in account-billing-view.js and render()"),this.$el.html(this.template(this.options.billing_data)),this.$cc_number=this.$("#cc_number"),this.$cc_cvv=this.$("#cc_cvv"),this.$cc_month=this.$("#cc_month"),this.$cc_year=this.$("#cc_year"),this},re_render:function(e){return console.log("in account-billing-view.js and re_render()"),this.$el.html(this.template(e)),this.$cc_number=this.$("#cc_number"),this.$cc_cvv=this.$("#cc_cvv"),this.$cc_month=this.$("#cc_month"),this.$cc_year=this.$("#cc_year"),this},cc_number_update:function(e){console.log("cc_number");return},cc_cvv_update:function(e){console.log("cc_cvv");return},cc_month_update:function(e){console.log("cc_month");return},cc_year_update:function(e){console.log("cc_year");return},cc_number_blur:function(e){console.log("cc_number_blur"),this.close_input_field(this.$cc_number,"cc_number");return},cc_cvv_blur:function(e){console.log("cc_cvv_blur"),this.close_input_field(this.$cc_cvv,"cc_cvv");return},cc_month_blur:function(e){console.log("cc_month_blur"),this.close_input_field(this.$cc_month,"cc_month");return},cc_year_blur:function(e){console.log("cc_year_blur"),this.close_input_field(this.$cc_year,"cc_year");return},close_input_field:function(e,t){console.log("close_input_field()"),console.dir(e),console.log("model_attribute: "+t);var n=e.val().trim(),r=this.braintree.encrypt(n);this.field_to_set[t]=r,console.log("value entered into field, "+t+" is "+n),console.log("encrpyted value of entered into field, "+t+" is "+r);return},change_cc:function(){console.log("change_cc handler"),this.$("#enter_new_cc_details").css("display","block")},submit:function(){var e=this;$.ajax({url:"/api/users/change_cc_details/",type:"POST",data:e.field_to_set,success:function(t,n,r){console.log("SUCCESS: submitted the cc to braintree"),console.dir(t),console.log(n),console.dir(r),e.$("#enter_new_cc_details").css("display","none");var i={};i.masked_number=t.customer.creditCards[0].maskedNumber,i.last_4=t.customer.creditCards[0].last4,i.expiration_date=t.customer.creditCards[0].expirationDate,e.re_render(i)},error:function(e,t,n){console.log("ERROR: failed setting the braintree cc in vault"),console.dir(e),console.log(t),console.dir(n)}})},show_view:function(e,t){return console.log("in show_view()"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return r}),define("text!tpl/AccountSettings.html",[],function(){return'<html>\n  <h2>Edit settings</h2>\n\n\n  <h5>User Details</h5>\n    <div id="change_user_details">\n    <p>\n    <label>First Name</label> \n    <input type="text" size="20" id="first_name"/>\n    </p>\n    <p>\n    <label>Last Name</label> \n    <input type="text" size="20" id="last_name"/>\n    </p>\n    <p>\n    <label>Email Address</label> \n    <input type="text" size="20" id="email_address"/>\n    </p>\n    <p>\n    <label>Phone Number</label> \n    <input type="text" size="20" id="phone_number"/>\n    </p>\n  </div>\n  <div id="submit_new_user_details" class="proceed">SUBMIT NEW USER DETAILS</div>\n\n\n  <h5>Change password</h5> \n  <div id="change_password">\n    <p>\n    <label>New Password</label>\n    <input type="password" size="20" id="new_password_1" />\n    </p>\n    <p>\n    <label>Retype new Password</label>\n    <input type="password" size="20" id="new_password_2" />\n    </p>\n  </div>\n  <div id="submit_new_password" class="proceed">SUBMIT NEW PASSWORD</div>\n\n\n</html>\n'}),define("text!tpl/UserFeedback.html",[],function(){return'<html>\n  <div class="user_feedback">Successful update</div>\n</html>\n'}),define("views/account-settings-view",["backbone","text!tpl/AccountSettings.html","text!tpl/UserFeedback.html"],function(e,t,n){var r=e.View.extend({tagName:"div",className:"account_settings_details",template:_.template(t),events:{"keypress #new_password_1":"new_password_1","keypress #new_password_2":"new_password_2","keypress #first_name":"first_name","keypress #last_name":"last_name","keypress #email_address":"email_address","keypress #phone_number":"phone_number","blur #new_password_1":"new_password_1_blur","blur #new_password_2":"new_password_2_blur","blur #first_name":"first_name_blur","blur #last_name":"last_name_blur","blur #email_address":"email_address_blur","blur #phone_number":"phone_number_blur","click #submit_new_password":"submit_new_password","click #submit_new_user_details":"submit_new_user_details"},initialize:function(){console.log("in initialize() of account-settings-view.js"),this.current_view=this},render:function(){return console.log("in account-settings-view.js and render()"),this.$el.html(this.template()),this.$first_name=this.$("#first_name"),this.$last_name=this.$("#last_name"),this.$email_address=this.$("#email_address"),this.$phone_number=this.$("#phone_number"),this.$new_password_1=this.$("#new_password_1"),this.$new_password_2=this.$("#new_password_2"),this.user_entered_data={},this},new_password_1:function(){console.log("new_password_1")},new_password_2:function(){console.log("new_password_1")},first_name:function(){console.log("first_name")},last_name:function(){console.log("last_name")},email_address:function(){console.log("email_address")},phone_number:function(){console.log("phone_number")},new_password_1_blur:function(){this.close_input_field(this.$new_password_1,"new_password_1")},new_password_2_blur:function(){this.close_input_field(this.$new_password_2,"new_password_2")},first_name_blur:function(){this.close_input_field(this.$first_name,"first_name")},last_name_blur:function(){this.close_input_field(this.$last_name,"last_name")},email_address_blur:function(){this.close_input_field(this.$email_address,"email_address")},phone_number_blur:function(){this.close_input_field(this.$phone_number,"phone_number")},close_input_field:function(e,t){var n=e.val().trim();this.user_entered_data[t]=n,console.log(this.user_entered_data)},submit_new_password:function(){console.log("in submit_new_password"),console.log(this.user_entered_data);var e=this;$.ajax({url:"/api/users/change_password/",type:"POST",data:e.user_entered_data,success:function(t,r,i){console.log("AJAX SUCCESS: posted the change password data"),console.dir(t),console.log(r),console.dir(i),t.errors?(console.log("error returned"),console.log(t),alert("error in input, check console.log")):(console.log($("#featureContent")),$("#featureContent").prepend(_.template(n)),e.render())},error:function(e,t,n){console.log("AJAX ERROR: in postin the change password data"),console.dir(e),console.log(t),console.dir(errorThrown)}})},submit_new_user_details:function(){console.log("in submit_new_user_details"),console.log(this.user_entered_data);var e=this;$.ajax({url:"/api/users/change_user_details",type:"POST",data:e.user_entered_data,success:function(t,r,i){console.log("AJAX SUCCESS: posted the change user details data"),console.dir(t),console.log(r),console.dir(i),t.errors?(console.log("error returned"),console.log(t),alert("error in input, check console.log")):(console.log($("#featureContent")),$("#featureContent").prepend(_.template(n)),e.render())},error:function(e,t,n){console.log("ERROR: in postin the change user details data"),console.dir(e),console.log(t),console.dir(errorThrown)}})},show_view:function(e,t){return console.log("in show_view()"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return r}),define("text!tpl/AccountBillingDefault.html",[],function(){return'<html>\n  <h3>User Account: Billing Details</h3>\n\n\n  <div>you have no yet entered a credit card to use for billing</div>\n\n\n  <div id="new_cc_details">\n    <h3>Enter details for your credit card.</h3>\n    <p>\n    <label>Card Number</label>\n    <input type="text" size="20" autocomplete="off" id="cc_number" data-encrypted-name\n="cc_number" />\n    </p>\n    <p>\n    <label>CVV</label>\n    <input type="text" size="4" autocomplete="off" id="cc_cvv" data-encrypted-name="cc\n_cvv" />\n    </p>\n    <p>\n    <label>Expiration (MM/YYYY)</label>\n    <input type="text" size="2" name="cc_month" id="cc_month"/> / <input type="text" s\nize="4" name="cc_year" id="cc_year"/>\n    </p>\n  \n    <div id="submit" class="proceed">SUBMIT</div>\n\n  </div>\n\n</html>\n'}),define("views/account-billing-default-view",["backbone","text!tpl/AccountBillingDefault.html","braintree","views/account-billing-view"],function(e,t,n,r){var i=e.View.extend({tagName:"div",className:"account_billing_default_details",template:_.template(t),events:{"keypress #cc_number":"cc_number_update","keypress #cc_cvv":"cc_cvv_update","keypress #cc_month":"cc_month_update","keypress #cc_year":"cc_year_update","blur #cc_number":"cc_number_blur","blur #cc_cvv":"cc_cvv_blur","blur #cc_month":"cc_month_blur","blur #cc_year":"cc_year_blur","click #submit":"submit"},initialize:function(){console.log("in initialize() of account-billing-default-view.js"),this.current_view=this,console.log("options:"),console.dir(this.options),this.braintree=n.create("MIIBCgKCAQEAwJo0HGLwcnHbj+LCBWEvxjjfZYTwoJuNvR34CevWwu71HeQ7s6kD9FuzK3nHFL0oA2/HchnhmWh4ilFzYq3/4U+hNLJwdG++MlZxQ9KlfLX2ROatmuOyIcD1mXKlKAEhuxU4OnTBnMByyzhy3Hz/9omOGWK0bjmSKkZabjwiqgs0E2VLeRaTERxWPPAKEPgKfiFjiYdOyYbXvvOtRU6kMze6ZoYnF098/RkrJuL8a+tn6otmQHJOvvLobJf0PYTH1YKEgx7JGhTQ0tvewd/gz4Lg8GMknM0HkGWaqtpLzeqahDGfik0PZQfWArvVQofOLVito0yY1Ck6G2A8mrjb/QIDAQAB"),console.log("braintree object"),console.dir(this.braintree)},render:function(){return console.log("in account-billing-default-view.js and render()"),this.$el.html(this.template()),this.$cc_number=this.$("#cc_number"),this.$cc_cvv=this.$("#cc_cvv"),this.$cc_month=this.$("#cc_month"),this.$cc_year=this.$("#cc_year"),this.field_to_set={},this},cc_number_update:function(e){console.log("cc_number");return},cc_cvv_update:function(e){console.log("cc_cvv");return},cc_month_update:function(e){console.log("cc_month");return},cc_year_update:function(e){console.log("cc_year");return},cc_number_blur:function(e){console.log("cc_number_blur"),this.close_input_field(this.$cc_number,"cc_number");return},cc_cvv_blur:function(e){console.log("cc_cvv_blur"),this.close_input_field(this.$cc_cvv,"cc_cvv");return},cc_month_blur:function(e){console.log("cc_month_blur"),this.close_input_field(this.$cc_month,"cc_month");return},cc_year_blur:function(e){console.log("cc_year_blur"),this.close_input_field(this.$cc_year,"cc_year");return},close_input_field:function(e,t){console.log("close_input_field()"),console.dir(e),console.log("model_attribute: "+t);var n=e.val().trim(),r=this.braintree.encrypt(n);this.field_to_set[t]=r,console.log("value entered into field, "+t+" is "+n),console.log("encrpyted value of entered into field, "+t+" is "+r);return},submit:function(){var e=this;console.log("in submit handler"),console.dir(this.field_to_set),$.ajax({url:"/api/users/change_cc_details/",type:"POST",data:e.field_to_set,success:function(t,n,i){console.log("SUCCESS: submitted the cc to braintree"),console.dir(t),console.log(n),console.dir(i);var s=new r({billing_data:t});console.log("billing_view is: "),console.dir(s),e.show_view("#account_main",s)},error:function(e,t,n){console.log("ERROR: failed setting the braintree cc in vault"),console.dir(e),console.log(t),console.dir(n)}})},show_view:function(e,t){return console.log("in show_view()"),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return i}),define("views/account-view",["backbone","text!tpl/AccountView.html","views/account-orders-view","views/account-billing-view","views/account-settings-view","collections/ordersCollection","views/account-billing-default-view"],function(e,t,n,r,i,s,o){var u=e.View.extend({tagName:"div",className:"account_details",template:_.template(t),events:{"click #account_orders":"orders","click #account_billing":"billing","click #account_settings":"settings"},initialize:function(){console.log("in initialize() of account-view.js")},render:function(){return console.log("in account-view.js and render()"),this.$el.html(this.template()),this},orders:function(){console.log("in orders handler");var e=this;this.orders_collection||(this.orders_collection=new s),this.orders_collection.fetch({success:function(t,r){console.log("SUCCESS in fetching the orders collection"),console.dir(t),console.log(r);var i=new n({model:t});e.show_view("#account_main",i)},error:function(e,t){console.log("ERROR in fetching the orders collection"),console.dir(e),console.log(t)}})},billing:function(){console.log("in billing handler");var e=this;$.ajax({url:"/api/users/account/billing_info/",type:"GET",success:function(t,n,i){console.log("SUCCESS: got billing info"),console.dir(t),console.log(n),console.dir(i);if(t.error){var s=new o;e.show_view("#account_main",s)}else{var u=new r({billing_data:t});e.show_view("#account_main",u)}},error:function(e,t,n){console.log("ERROR: could not got billing info"),console.dir(e),console.log(t),console.dir(n)}})},settings:function(){console.log("in settingshandler");var e=new i;this.show_view("#account_main",e)},show_view:function(e,t){return console.log("in show_view, and this.current_view is: "),console.log(this.current_view),this.current_view&&this.current_view.close(),$(e).html(t.render().el),this.current_view=t,t}});return u}),define("text!tpl/PrivacyPolicyView.html",[],function(){return"<html>\n  <div>\n    <h3>Privacy Policy</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  lkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjldasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjlad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/privacy-policy-view",["backbone","text!tpl/PrivacyPolicyView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"privacy_policy_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of privacy-policy-view.js")},render:function(){return console.log("in privacy-policy-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("text!tpl/ReturnsPolicyView.html",[],function(){return"<html>\n  <div>\n    <h3>Returns Policy</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  lkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjldasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjlad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/returns-policy-view",["backbone","text!tpl/ReturnsPolicyView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"returns_policy_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of returns-policy-view.js")},render:function(){return console.log("in returns-policy-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("text!tpl/TicketTypesView.html",[],function(){return"<html>\n  <div>\n    <h3>Ticket Types</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  lkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjldasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjlad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/ticket-types-view",["backbone","text!tpl/TicketTypesView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"ticket_types_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of ticket-types-view.js")},render:function(){return console.log("in ticket-types-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("text!tpl/NewsletterView.html",[],function(){return"<html>\n  <div>\n    <h3>Newsletter</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  lkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjldasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjlad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/newsletter-view",["backbone","text!tpl/NewsletterView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"newsletter_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of newsletter-view.js")},render:function(){return console.log("in newsletter-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("text!tpl/FaqView.html",[],function(){return"<html>\n  <div>\n    <h3>FAQ</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  lkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjldasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjlad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/faq-view",["backbone","text!tpl/FaqView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"faq_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of faq-view.js")},render:function(){return console.log("in faq-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("text!tpl/SearchView.html",[],function(){return"<html>\n  <div>\n    <h3>Search</h3>\n    <p>isldkf lsdlkk jsdfkjldskljsdfkjls sdfjkskljsklj jkslkjsdlk kljsdlkf jk kj l lkj  lkjlkj sadflkjsdflkjsf kjlaskljadsjkl asdasdjkl asjkladsjkladsjkl kjldfgjklfds kjljkl kjldasffdsklj kjlkjsdfjklfsdklj  kljsdfklj kljsdfj asdjkl as a a as dsakasklj kljasdjklasdkjlad asdkljasdklj jklasdkljaddalkj jk klj kljkl klkj kkjkl kl klj jklasdfkljasf</p>\n  </div>\n</html>\n"}),define("views/search-view",["backbone","text!tpl/SearchView.html"],function(e,t){var n=e.View.extend({tagName:"div",className:"search_details",template:_.template(t),events:{},initialize:function(){console.log("in initialize() of search-view.js")},render:function(){return console.log("in search-view.js and render()"),this.$el.html(this.template()),this}});return n}),define("routers/router",["backbone","views/gigs-view","views/about-view","views/contact-view","views/login-view","views/home-landing-view","views/gig-detail-view","collections/gigGuide","views/gig-guide-landing-view","models/user-model","views/user-details-view","views/logged-out-view","models/order-model","views/number-of-tickets-view","collections/ordersCollection","views/checkout-view","views/account-view","views/register-view","views/privacy-policy-view","views/returns-policy-view","views/ticket-types-view","views/newsletter-view","views/faq-view","views/search-view"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){var T=e.Router.extend({initialize:function(){console.log("in initialize() of router.js")},routes:{"":"index",about:"about",login:"login",contact:"contact",gigs:"gig_guide","gigs/:id":"gig_details","users/session/:id":"session",logout:"logout","users/session/goodbye":"goodbye","delete-user-account/:id":"delete_user_account",account:"account",privacy_policy:"privacy_policy",returns_policy:"returns_policy",ticket_types:"ticket_types",newsletter:"newsletter",faq:"faq",search:"search",register:"register"},register:function(){console.log("in register() of router.js"),this.check_authentication_set_links(),this.theRegisterView||(this.theRegisterView=new g),this.show_view("#featureContent",this.theRegisterView)},privacy_policy:function(){console.log("in privacy_policy handler"),this.thePrivacyPolicyView||(this.thePrivacyPolicyView=new y),this.show_view("#featureContent",this.thePrivacyPolicyView)},returns_policy:function(){console.log("in returns_policy handler"),this.theReturnsPolicyView||(this.theReturnsPolicyView=new b),this.show_view("#featureContent",this.theReturnsPolicyView)},ticket_types:function(){console.log("in ticket_types handler"),this.theTicketTypesView||(this.theTicketTypesView=new w),this.show_view("#featureContent",this.theTicketTypesView)},newsletter:function(){console.log("in newsletter handler"),this.theNewsletterView||(this.theNewsletterView=new E),this.show_view("#featureContent",this.theNewsletterView)},faq:function(){console.log("in faq handler"),this.theFaqView||(this.theFaqView=new S),this.show_view("#featureContent",this.theFaqView)},search:function(){console.log("in search handler"),this.theSearchView||(this.theSearchView=new x),this.show_view("#featureContent",this.theSearchView)},check_authentication_set_links:function(){console.log("in check_authentication_set_links handler");var e=this;$.ajax({url:"/api/users/session",type:"GET",success:function(t,n,r){t.user_authenticated===!0&&(console.dir(t),console.log("Get response: yuppupupup"),console.log(n),console.dir(r),e.switch_log_button("#logout_header","#login_header"),e.display_account_tab(!0))}})},account:function(){console.log("in account handler"),this.check_authentication_set_links();var e=new m;this.show_view("#featureContent",e)},index:function(){console.log("in index() of router.js"),this.check_authentication_set_links(),this.theHomeLandingView||(this.theHomeLandingView=new s),this.show_view("#featureContent",this.theHomeLandingView)},about:function(){console.log("in about() of router.js"),this.check_authentication_set_links(),this.theAboutView||(this.theAboutView=new n),this.show_view("#featureContent",this.theAboutView)},login:function(){console.log("in login() of router.js"),this.check_authentication_set_links();var e=new i;this.show_view("#featureContent",e)},contact:function(){console.log("in contact() of router.js"),this.check_authentication_set_links(),this.theContactView||(this.theContactView=new r),this.show_view("#featureContent",this.theContactView)},gig_guide:function(){console.log("in gigGuide() of router.js"),this.check_authentication_set_links(),this.theGigList||(this.theGigList=new u);var e=this;this.theGigList.fetch({success:function(n,r){console.log("self.theGigList.length = "+e.theGigList.length),e.theGigsView=new t({model:e.theGigList}),e.show_view("#featureContent",e.theGigsView),e.requestedId&&(e.navigate("//gigs/"+e.requestedId),e.gigDetails(e.requestedId),e.requestedId=null)},error:function(e,t){console.log("ERROR: in router.js and gigGuide handler")}})},gig_details:function(e){console.log("in getDetails() of router.js, with id = "+e),this.check_authentication_set_links(),this.defaultLandingView&&(console.log("gigDetails() of router.js and this.defaultLandingView is != null"),this.defaultLandingView.close(),this.defaultLandingView=null),this.theGigList?(this.gig=this.theGigList.get(e),this.selectedGigPrice=this.gig.get("price"),this.show_view("#featureContent",new o({model:this.gig}))):(this.requestedId=e,this.gigGuide())},session:function(e){console.log("USER AUTHENTICATED: in session() in router.js"),console.log("USER AUTHENTICATED:id: "+e+" in session() in router.js");if(!this.userDetailsView){this.userModel=new f({_id:e}),console.log("userModel id: "+this.userModel.get("_id"));var t=this;this.userModel.fetch({success:function(e,n,r){console.log("SUCCESS: in session handler. fetched user data from server."),console.dir(e),t.userDetailsView=new l({model:e}),t.navigate("#/hello/"+e.get("first_name"),{replace:!0}),t.show_view("#featureContent",t.userDetailsView),t.switch_log_button("#logout_header","#login_header"),t.display_account_tab(!0)},error:function(e,t,n){console.log("ERROR: in session handler of router.js")}})}},logout:function(){console.log("in logout() route."),this.order&&(console.log("reset this.order to null, since you logged out."),this.order=null);var e=this;$.ajax({url:"/api/users/logout",type:"DELETE",success:function(t,n,r){console.dir(t),console.log("Delete response:"),console.log(n),console.dir(r),e.goodbye(t)}}),this.switch_log_button("#login_header","#logout_header"),this.display_account_tab(!1)},goodbye:function(e){this.loggedOutView||(this.loggedOutView=new c),this.navigate("#/goodbye/"+e,{replace:!0}),this.show_view("#featureContent",this.loggedOutView)},delete_user_account:function(e){console.log("and this.userModel.get('id'): "+this.userModel.get("_id"));var t=this;$.ajax({url:"/api/users/session",type:"GET",success:function(n,r,i){console.dir(n),console.log("Get response:"),console.log(r),console.dir(i),n._id===e&&n.authenticated===!0&&t.userModel&&t.userModel.get("_id")===e?(console.log("in deleteUserAccount handler, self.userModel is defined and self.userModel.get('id'): "+t.userModel.get("_id")+"and self.userModel.get('id') === id (from url param) is true "),t.userModel.destroy({success:function(e,n){console.log("in success callback in self.userModel.destroy()"),console.dir(e),console.log("in success callback,  response:"),console.dir(n),t.logout()},error:function(e,t){console.log("in error callback in self.userModel.destroy()"),console.dir(e),console.log("in error callback,  response:"),console.dir(t)}})):console.log("in deleteUserAccount handler and !this.userModel === true")}})},switch_log_button:function(e,t){$(t).css("display","none"),$(e).css("display","block")},display_account_tab:function(e){e?$("#account").css("display","block"):$("#account").css("display","none")},show_view:function(e,t){return console.log("in showView()"),console.log("in showView(), this.currentView: "),console.log(this.currentView),this.currentView&&this.currentView.close(),$(e).html(t.render().el),this.currentView=t,t}});return T}),function(e){var t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=["January","February","March","April","May","June","July","August","September","October","November","December"],i=[];i.Jan="01",i.Feb="02",i.Mar="03",i.Apr="04",i.May="05",i.Jun="06",i.Jul="07",i.Aug="08",i.Sep="09",i.Oct="10",i.Nov="11",i.Dec="12",e.format=function(){function e(e){return t[parseInt(e,10)]||e}function s(e){var t=parseInt(e,10)-1;return n[t]||e}function o(e){var t=parseInt(e,10)-1;return r[t]||e}var u=function(e){return i[e]||e},a=function(e){var t=e,n="";if(t.indexOf(".")!==-1){var r=t.split(".");t=r[0],n=r[1]}var i=t.split(":");return i.length===3?(hour=i[0],minute=i[1],second=i[2],{time:t,hour:hour,minute:minute,second:second,millis:n}):{time:"",hour:"",minute:"",second:"",millis:""}},f=function(e,t){var n=t-String(e).length;for(var r=0;r<n;r++)e="0"+e;return e};return{date:function(t,n){try{var r=null,i=null,l=null,c=null,h=null,p=null;if(typeof t=="number")return this.date(new Date(t),n);if(typeof t.getFullYear=="function")i=t.getFullYear(),l=t.getMonth()+1,c=t.getDate(),h=t.getDay(),p=a(t.toTimeString());else if(t.search(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?\d{0,3}[Z\-+]?(\d{2}:?\d{2})?/)!=-1){var d=t.split(/[T\+-]/);i=d[0],l=d[1],c=d[2],p=a(d[3].split(".")[0]),r=new Date(i,l-1,c),h=r.getDay()}else{var d=t.split(" ");switch(d.length){case 6:i=d[5],l=u(d[1]),c=d[2],p=a(d[3]),r=new Date(i,l-1,c),h=r.getDay();break;case 2:var v=d[0].split("-");i=v[0],l=v[1],c=v[2],p=a(d[1]),r=new Date(i,l-1,c),h=r.getDay();break;case 7:case 9:case 10:i=d[3],l=u(d[1]),c=d[2],p=a(d[4]),r=new Date(i,l-1,c),h=r.getDay();break;case 1:var v=d[0].split("");i=v[0]+v[1]+v[2]+v[3],l=v[5]+v[6],c=v[8]+v[9],p=a(v[13]+v[14]+v[15]+v[16]+v[17]+v[18]+v[19]+v[20]),r=new Date(i,l-1,c),h=r.getDay();break;default:return t}}var m="",g="",y="";for(var b=0;b<n.length;b++){var w=n.charAt(b);m+=w,y="";switch(m){case"ddd":g+=e(h),m="";break;case"dd":if(n.charAt(b+1)=="d")break;g+=f(c,2),m="";break;case"d":if(n.charAt(b+1)=="d")break;g+=parseInt(c,10),m="";break;case"D":c==1||c==21||c==31?c+="st":c==2||c==22?c+="nd":c==3||c==23?c+="rd":c+="th",g+=c,m="";break;case"MMMM":g+=o(l),m="";break;case"MMM":if(n.charAt(b+1)==="M")break;g+=s(l),m="";break;case"MM":if(n.charAt(b+1)=="M")break;g+=f(l,2),m="";break;case"M":if(n.charAt(b+1)=="M")break;g+=parseInt(l,10),m="";break;case"y":case"yyy":if(n.charAt(b+1)=="y")break;g+=m,m="";break;case"yy":if(n.charAt(b+1)=="y"&&n.charAt(b+2)=="y")break;g+=String(i).slice(-2),m="";break;case"yyyy":g+=i,m="";break;case"HH":g+=f(p.hour,2),m="";break;case"H":if(n.charAt(b+1)=="H")break;g+=parseInt(p.hour,10),m="";break;case"hh":var E=p.hour==0?12:p.hour<13?p.hour:p.hour-12;g+=f(E,2),m="";break;case"h":if(n.charAt(b+1)=="h")break;var E=p.hour==0?12:p.hour<13?p.hour:p.hour-12;g+=parseInt(E,10),m="";break;case"mm":g+=f(p.minute,2),m="";break;case"m":if(n.charAt(b+1)=="m")break;g+=p.minute,m="";break;case"ss":g+=f(p.second.substring(0,2),2),m="";break;case"s":if(n.charAt(b+1)=="s")break;g+=p.second,m="";break;case"S":case"SS":if(n.charAt(b+1)=="S")break;g+=m,m="";break;case"SSS":g+=p.millis.substring(0,3),m="";break;case"a":g+=p.hour>=12?"PM":"AM",m="";break;case"p":g+=p.hour>=12?"p.m.":"a.m.",m="";break;default:g+=w,m=""}}return g+=y,g}catch(S){return console.log(S),t}}}}()}(jQuery),jQuery.format.date.defaultShortDateFormat="dd/MM/yyyy",jQuery.format.date.defaultLongDateFormat="dd/MM/yyyy HH:mm:ss",jQuery(document).ready(function(){jQuery(".shortDateFormat").each(function(e,t){jQuery(t).is(":input")?jQuery(t).val(jQuery.format.date(jQuery(t).val(),jQuery.format.date.defaultShortDateFormat)):jQuery(t).text(jQuery.format.date(jQuery(t).text(),jQuery.format.date.defaultShortDateFormat))}),jQuery(".longDateFormat").each(function(e,t){jQuery(t).is(":input")?jQuery(t).val(jQuery.format.date(jQuery(t).val(),jQuery.format.date.defaultLongDateFormat)):jQuery(t).text(jQuery.format.date(jQuery(t).text(),jQuery.format.date.defaultLongDateFormat))})}),define("jquery-dateFormat-1.0",function(){}),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning)return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning)return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var n=e.fn.collapse;e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=n,this},e(document).on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})}(window.jQuery),define("bootstrap-collapse",function(){}),require.config({baseUrl:"js/lib",paths:{views:"../views",models:"../models",collections:"../collections",routers:"../routers",tpl:"../tpl"},shim:{underscore:{exports:"_"},backbone:{deps:["underscore","jquery-1.10.2.min"],exports:"Backbone"},"bootstrap.min":["jquery-1.10.2.min"],"jquery-dateFormat-1.0":["jquery-1.10.2.min"],"bootstrap-collapse":["jquery-1.10.2.min"]}}),require(["backbone","views/banner-view","views/header-view","routers/router","jquery-dateFormat-1.0","bootstrap-collapse"],function(e,t,n,r){$(function(){e.View.prototype.close=function(){console.log("CLOSE VIEW: in app.js and Backbone.View.prototype.close"),this.beforeClose&&this.beforeClose(),this.remove(),this.unbind()},console.log("in app.js and $(document).ready(handler) handler");var i=new n,s=new t,o=new r;e.history.start()})}),define("app",function(){});